Iteration...1
Finished step   -1  Threshold: 1.00948
Finished step    0  Threshold: 1.00369
Finished step    1  Threshold: 1.01
Finished step    2  Threshold: 1.01023
Finished step    3  Threshold: 0.999912
Finished step    4  Threshold: 1.00327
Finished step    5  Threshold: 1.00327

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.083964
Updating template for sample...1
{Error: File: /home/pai/Zie_Template_Estimation/NonRigid/logPosteriorLambda.m Line: 42 Column: 20
Expression or statement is incorrect--possibly unbalanced (, {, or [.

Error in autoGrad (line 14)
	f = funObj(x,varargin{:});

Error in minFunc (line 314)
    [f,g] = funObj(x,varargin{:});

Error in EMTemplate (line 99)
            pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams{k});

Error in mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, ssd, 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Parallel pool using the 'local' profile is shutting down.
Starting parallel pool (parpool) using the 'local' profile ... connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.00357
Finished step    0  Threshold: 1.00405
Finished step    1  Threshold: 1.00142
Finished step    2  Threshold: 1.00757
Finished step    3  Threshold: 1.00179
Finished step    4  Threshold: 1.00299
Finished step    5  Threshold: 1.00878

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.060231
Updating template for sample...1

ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

     1


ffSupportCov =

     1


lp =

   NaN


ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

    1.0000


ffSupportCov =

     1


lp =

   NaN

 Iteration   FunEvals     Step Length    Function Val        Opt Cond
Step direction is illegal!
{Operation terminated by user during minFunc (line 964)


In EMTemplate (line 99)
            pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams{k});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, ssd, 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.00464
Finished step    0  Threshold: 1.00575
Finished step    1  Threshold: 1.00397
Finished step    2  Threshold: 1.01455
Finished step    3  Threshold: 1.00593
Finished step    4  Threshold: 1.00701
Finished step    5  Threshold: 0.998035

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.065058
Updating template for sample...1

ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

     1


ffSupportCov =

     1


lp =

   NaN


ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

    1.0000


ffSupportCov =

     1


lp =

   NaN

 Iteration   FunEvals     Step Length    Function Val        Opt Cond
Step direction is illegal!
{Operation terminated by user during minFunc (line 964)


In EMTemplate (line 99)
            pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams{k});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, ssd, 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.00507
Finished step    0  Threshold: 1.00243
Finished step    1  Threshold: 1.00627
Finished step    2  Threshold: 1.0054
Finished step    3  Threshold: 1.00274
Finished step    4  Threshold: 1.00616
Finished step    5  Threshold: 1.01579

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.058452
Updating template for sample...1

ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

     1


ffSupportCov =

     1


lp =

   NaN


ans =

   (1,1)           5616


ans =

   (1,1)           5616


lambda =

    1.0000


ffSupportCov =

     1


lp =

   NaN

 Iteration   FunEvals     Step Length    Function Val        Opt Cond
Step direction is illegal!
{Operation terminated by user during minFunc (line 964)


In EMTemplate (line 99)
            pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams{k});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, ssd, 1, voxelSize, image,numSamples);
} 
ls
C.mat		       imagegradBSP.mexmaci64	       NMI3D_DET_PW3.cpp	      wendkernbuncompositioninterpolation.cpp	     wendkernbuncompositionparallel.cpp
dDdPFuncJac.cpp        jacobiandettransform.cpp        NMI3D_DET_PW3.mexa64	      wendkernbuncompositioninterpolation.mexa64     wendkernbuncompositionparallel.mexa64
dDdPFuncJac.mexa64     jacobiandettransform.mexa64     NMI3D_DET_PW3.mexmaci64	      wendkernbuncompositioninterpolation.mexmaci64  wendkernbuncompositionparallel.mexmaci64
dDdPFuncJac.mexmaci64  jacobiandettransform.mexmaci64  SplineInterpolation.cpp	      wendkernbuncompositionJacobian.cpp	     wendsquarednorm.cpp
imagegradBSP.cpp       Kroenecker.h		       SplineInterpolation.mexa64     wendkernbuncompositionJacobian.mexa64	     wendsquarednorm.mexa64
imagegradBSP.mexa64    log.txt			       SplineInterpolation.mexmaci64  wendkernbuncompositionJacobian.mexmaci64	     wendsquarednorm.mexmaci64

mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.00272
Finished step    0  Threshold: 1.00412
Finished step    1  Threshold: 1.00011
Finished step    2  Threshold: 1.00406
Finished step    3  Threshold: 1.0097
Finished step    4  Threshold: 1.00936
Finished step    5  Threshold: 1.00292

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.057089
Updating template for sample...1

ans =

   All zero sparse: 1-by-1


ans =

   All zero sparse: 1-by-1


lambda =

     1


ffSupportCov =

     2


lp =

   5.1213e+04


ans =

   All zero sparse: 1-by-1


ans =

   All zero sparse: 1-by-1


lambda =

    1.0000


ffSupportCov =

     2


lp =

   5.1213e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

ans =

   All zero sparse: 1-by-1


ans =

   All zero sparse: 1-by-1


lambda =

     0


ffSupportCov =

     2


lp =

   5.1212e+04


ans =

   All zero sparse: 1-by-1


ans =

   All zero sparse: 1-by-1


lambda =

   2.0000e-06


ffSupportCov =

     2


lp =

   5.1212e+04

         1          4     1.78014e-04     5.12117e+04     1.55846e+00

ans =

   All zero sparse: 1-by-1


ans =

   All zero sparse: 1-by-1


lambda =

  -2.7750e-04


ffSupportCov =

     2


lp =

   5.1212e+04

{Operation terminated by user during logPosteriorLambda (line 37)


In autoGrad (line 20)
		diff(j,1) = funObj(x + mu*e_j,varargin{:});

In WolfeLineSearch (line 34)
    [f_new,g_new] = funObj(x+t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 99)
            pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams{k});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, ssd, 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.0153
Finished step    0  Threshold: 0.999192
Finished step    1  Threshold: 1.00449
Finished step    2  Threshold: 1.00917
Finished step    3  Threshold: 0.997324
Finished step    4  Threshold: 0.995062
Finished step    5  Threshold: 1.01522

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.065485
Updating template for sample...1

lambda =

     1


lp =

   5.1187e+04


lambda =

    1.0000


lp =

   5.1187e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1185e+04


lambda =

   2.0000e-06


lp =

   5.1185e+04

         1          4     1.78000e-04     5.11847e+04     1.98738e+00

lambda =

  -3.5388e-04


lp =

   5.1185e+04


lambda =

  -3.5188e-04


lp =

   5.1185e+04


lambda =

   -0.0035


lp =

   5.1185e+04


lambda =

   -0.0035


lp =

   5.1185e+04


lambda =

   -0.0354


lp =

   5.1185e+04


lambda =

   -0.0354


lp =

   5.1185e+04


lambda =

   -0.3539


lp =

   5.1184e+04


lambda =

   -0.3539


lp =

   5.1184e+04


lambda =

   -3.5388


lp =

   5.1178e+04


lambda =

   -3.5388


lp =

   5.1178e+04


lambda =

  -35.3880


lp =

   5.1114e+04


lambda =

  -35.3879


lp =

   5.1114e+04


lambda =

 -353.8797


lp =

   5.0481e+04


lambda =

 -353.8789


lp =

   5.0481e+04


lambda =

  -3.5388e+03


lp =

   4.4152e+04


lambda =

  -3.5388e+03


lp =

   4.4152e+04


lambda =

  -3.5388e+04


lp =

  -1.9145e+04


lambda =

  -3.5388e+04


lp =

  -1.9145e+04


lambda =

  -3.5388e+05


lp =

  -6.5211e+05


lambda =

  -3.5388e+05


lp =

  -6.5211e+05


lambda =

  -3.5388e+06


lp =

  -6.9818e+06


lambda =

  -3.5388e+06


lp =

  -6.9817e+06


lambda =

  -3.5388e+07


lp =

  -7.0278e+07


lambda =

  -3.5388e+07


lp =

  -7.0278e+07


lambda =

  -3.5388e+08


lp =

  -7.0324e+08


lambda =

  -3.5388e+08


lp =

  -7.0324e+08


lambda =

  -3.5388e+09


lp =

  -7.0329e+09


lambda =

  -3.5388e+09


lp =

  -7.0329e+09


lambda =

  -3.5388e+10


lp =

  -7.0329e+10


lambda =

  -3.5388e+10


lp =

  -7.0329e+10


lambda =

  -3.5388e+11


lp =

  -7.0329e+11


lambda =

  -3.5388e+11


lp =

  -7.0329e+11


lambda =

  -3.5388e+12


lp =

  -7.0329e+12


lambda =

  -3.5388e+12


lp =

  -7.0329e+12


lambda =

  -3.5388e+13


lp =

  -7.0329e+13


lambda =

  -3.5388e+13


lp =

  -7.0329e+13


lambda =

  -3.5388e+14


lp =

  -7.0329e+14


lambda =

  -3.5388e+14


lp =

  -7.0329e+14


lambda =

  -3.5388e+15


lp =

  -7.0329e+15


lambda =

  -3.5388e+15


lp =

  -7.0329e+15


lambda =

  -3.5388e+16


lp =

  -7.0329e+16


lambda =

  -3.5388e+16


lp =

  -7.0329e+16


lambda =

  -3.5388e+17


lp =

  -7.0329e+17


lambda =

  -3.5388e+17


lp =

  -7.0329e+17


lambda =

  -3.5388e+18


lp =

  -7.0329e+18


lambda =

  -3.5388e+18


lp =

  -7.0329e+18


lambda =

  -3.5388e+19


lp =

  -7.0329e+19


lambda =

  -3.5388e+19


lp =

  -7.0329e+19


lambda =

  -3.5388e+20


lp =

  -7.0329e+20


lambda =

  -3.5388e+20


lp =

  -7.0329e+20


lambda =

  -3.5388e+21


lp =

  -7.0329e+21


lambda =

  -3.5388e+21


lp =

  -7.0329e+21

         2         56     1.00000e+25    -7.03295e+21     1.98738e+00
Reached Maximum Number of Function Evaluations
Updating template for sample...1

lambda =

     1


lp =

   5.1187e+04


lambda =

    1.0000


lp =

   5.1187e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1185e+04


lambda =

   2.0000e-06


lp =

   5.1185e+04

         1          4     1.78000e-04     5.11847e+04     1.98738e+00

lambda =

  -3.5388e-04


lp =

   5.1185e+04


lambda =

  -3.5188e-04


lp =

   5.1185e+04


lambda =

   -0.0035


lp =

   5.1185e+04


lambda =

   -0.0035


lp =

   5.1185e+04


lambda =

   -0.0354


lp =

   5.1185e+04


lambda =

   -0.0354


lp =

   5.1185e+04


lambda =

   -0.3539


lp =

   5.1184e+04


lambda =

   -0.3539


lp =

   5.1184e+04


lambda =

   -3.5388


lp =

   5.1178e+04


lambda =

   -3.5388


lp =

   5.1178e+04


lambda =

  -35.3880


lp =

   5.1114e+04


lambda =

  -35.3879


lp =

   5.1114e+04


lambda =

 -353.8797


lp =

   5.0481e+04


lambda =

 -353.8789


lp =

   5.0481e+04


lambda =

  -3.5388e+03


lp =

   4.4152e+04


lambda =

  -3.5388e+03


lp =

   4.4152e+04


lambda =

  -3.5388e+04


lp =

  -1.9145e+04


lambda =

  -3.5388e+04


lp =

  -1.9145e+04


lambda =

  -3.5388e+05


lp =

  -6.5211e+05


lambda =

  -3.5388e+05


lp =

  -6.5211e+05


lambda =

  -3.5388e+06


lp =

  -6.9818e+06


lambda =

  -3.5388e+06


lp =

  -6.9817e+06


lambda =

  -3.5388e+07


lp =

  -7.0278e+07


lambda =

  -3.5388e+07


lp =

  -7.0278e+07


lambda =

  -3.5388e+08


lp =

  -7.0324e+08


lambda =

  -3.5388e+08


lp =

  -7.0324e+08


lambda =

  -3.5388e+09


lp =

  -7.0329e+09


lambda =

  -3.5388e+09


lp =

  -7.0329e+09


lambda =

  -3.5388e+10


lp =

  -7.0329e+10


lambda =

  -3.5388e+10


lp =

  -7.0329e+10


lambda =

  -3.5388e+11


lp =

  -7.0329e+11


lambda =

  -3.5388e+11


lp =

  -7.0329e+11


lambda =

  -3.5388e+12


lp =

  -7.0329e+12


lambda =

  -3.5388e+12


lp =

  -7.0329e+12


lambda =

  -3.5388e+13


lp =

  -7.0329e+13


lambda =

  -3.5388e+13


lp =

  -7.0329e+13


lambda =

  -3.5388e+14


lp =

  -7.0329e+14


lambda =

  -3.5388e+14


lp =

  -7.0329e+14


lambda =

  -3.5388e+15


lp =

  -7.0329e+15


lambda =

  -3.5388e+15


lp =

  -7.0329e+15


lambda =

  -3.5388e+16


lp =

  -7.0329e+16


lambda =

  -3.5388e+16


lp =

  -7.0329e+16


lambda =

  -3.5388e+17


lp =

  -7.0329e+17


lambda =

  -3.5388e+17


lp =

  -7.0329e+17


lambda =

  -3.5388e+18


lp =

  -7.0329e+18


lambda =

  -3.5388e+18


lp =

  -7.0329e+18


lambda =

  -3.5388e+19


lp =

  -7.0329e+19


lambda =

  -3.5388e+19


lp =

  -7.0329e+19


lambda =

  -3.5388e+20


lp =

  -7.0329e+20


lambda =

  -3.5388e+20


lp =

  -7.0329e+20


lambda =

  -3.5388e+21


lp =

  -7.0329e+21


lambda =

  -3.5388e+21


lp =

  -7.0329e+21

         2         56     1.00000e+25    -7.03295e+21     1.98738e+00
Reached Maximum Number of Function Evaluations
Max magnitude of deformation in sample...2	0.077794
Updating template for sample...2

lambda =

     1


lp =

   5.1173e+04


lambda =

    1.0000


lp =

   5.1173e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1170e+04


lambda =

   2.0000e-06


lp =

   5.1170e+04

         1          4     1.77978e-04     5.11699e+04     2.68755e+00

lambda =

  -4.7855e-04


lp =

   5.1170e+04


lambda =

  -4.7655e-04


lp =

   5.1170e+04


lambda =

   -0.0048


lp =

   5.1170e+04


lambda =

   -0.0048


lp =

   5.1170e+04


lambda =

   -0.0479


lp =

   5.1170e+04


lambda =

   -0.0479


lp =

   5.1170e+04


lambda =

   -0.4786


lp =

   5.1169e+04


lambda =

   -0.4786


lp =

   5.1169e+04


lambda =

   -4.7855


lp =

   5.1157e+04


lambda =

   -4.7855


lp =

   5.1157e+04


lambda =

  -47.8554


lp =

   5.1041e+04


lambda =

  -47.8553


lp =

   5.1041e+04


lambda =

 -478.5539


lp =

   4.9884e+04


lambda =

 -478.5529


lp =

   4.9884e+04


lambda =

  -4.7855e+03


lp =

   3.8308e+04


lambda =

  -4.7855e+03


lp =

   3.8309e+04


lambda =

  -4.7855e+04


lp =

  -7.7444e+04


lambda =

  -4.7855e+04


lp =

  -7.7444e+04


lambda =

  -4.7855e+05


lp =

  -1.2350e+06


lambda =

  -4.7855e+05


lp =

  -1.2350e+06


lambda =

  -4.7855e+06


lp =

  -1.2810e+07


lambda =

  -4.7855e+06


lp =

  -1.2810e+07


lambda =

  -4.7855e+07


lp =

  -1.2856e+08


lambda =

  -4.7855e+07


lp =

  -1.2856e+08


lambda =

  -4.7855e+08


lp =

  -1.2861e+09


lambda =

  -4.7855e+08


lp =

  -1.2861e+09


lambda =

  -4.7855e+09


lp =

  -1.2861e+10


lambda =

  -4.7855e+09


lp =

  -1.2861e+10


lambda =

  -4.7855e+10


lp =

  -1.2861e+11


lambda =

  -4.7855e+10


lp =

  -1.2861e+11


lambda =

  -4.7855e+11


lp =

  -1.2861e+12


lambda =

  -4.7855e+11


lp =

  -1.2861e+12


lambda =

  -4.7855e+12


lp =

  -1.2861e+13


lambda =

  -4.7855e+12


lp =

  -1.2861e+13


lambda =

  -4.7855e+13


lp =

  -1.2861e+14


lambda =

  -4.7855e+13


lp =

  -1.2861e+14


lambda =

  -4.7855e+14


lp =

  -1.2861e+15


lambda =

  -4.7855e+14


lp =

  -1.2861e+15


lambda =

  -4.7855e+15


lp =

  -1.2861e+16


lambda =

  -4.7855e+15


lp =

  -1.2861e+16


lambda =

  -4.7855e+16


lp =

  -1.2861e+17


lambda =

  -4.7855e+16


lp =

  -1.2861e+17


lambda =

  -4.7855e+17


lp =

  -1.2861e+18


lambda =

  -4.7855e+17


lp =

  -1.2861e+18


lambda =

  -4.7855e+18


lp =

  -1.2861e+19


lambda =

  -4.7855e+18


lp =

  -1.2861e+19


lambda =

  -4.7855e+19


lp =

  -1.2861e+20


lambda =

  -4.7855e+19


lp =

  -1.2861e+20


lambda =

  -4.7855e+20


lp =

  -1.2861e+21


lambda =

  -4.7855e+20


lp =

  -1.2861e+21


lambda =

  -4.7855e+21


lp =

  -1.2861e+22


lambda =

  -4.7855e+21


lp =

  -1.2861e+22

         2         56     1.00000e+25    -1.28614e+22     2.68755e+00
Reached Maximum Number of Function Evaluations
Updating template for sample...2

lambda =

     1


lp =

   5.1173e+04


lambda =

    1.0000


lp =

   5.1173e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1170e+04


lambda =

   2.0000e-06


lp =

   5.1170e+04

         1          4     1.77978e-04     5.11699e+04     2.68755e+00

lambda =

  -4.7855e-04


lp =

   5.1170e+04


lambda =

  -4.7655e-04


lp =

   5.1170e+04


lambda =

   -0.0048


lp =

   5.1170e+04


lambda =

   -0.0048


lp =

   5.1170e+04


lambda =

   -0.0479


lp =

   5.1170e+04


lambda =

   -0.0479


lp =

   5.1170e+04


lambda =

   -0.4786


lp =

   5.1169e+04


lambda =

   -0.4786


lp =

   5.1169e+04


lambda =

   -4.7855


lp =

   5.1157e+04


lambda =

   -4.7855


lp =

   5.1157e+04


lambda =

  -47.8554


lp =

   5.1041e+04


lambda =

  -47.8553


lp =

   5.1041e+04


lambda =

 -478.5539


lp =

   4.9884e+04


lambda =

 -478.5529


lp =

   4.9884e+04


lambda =

  -4.7855e+03


lp =

   3.8308e+04


lambda =

  -4.7855e+03


lp =

   3.8309e+04


lambda =

  -4.7855e+04


lp =

  -7.7444e+04


lambda =

  -4.7855e+04


lp =

  -7.7444e+04


lambda =

  -4.7855e+05


lp =

  -1.2350e+06


lambda =

  -4.7855e+05


lp =

  -1.2350e+06


lambda =

  -4.7855e+06


lp =

  -1.2810e+07


lambda =

  -4.7855e+06


lp =

  -1.2810e+07


lambda =

  -4.7855e+07


lp =

  -1.2856e+08


lambda =

  -4.7855e+07


lp =

  -1.2856e+08


lambda =

  -4.7855e+08


lp =

  -1.2861e+09


lambda =

  -4.7855e+08


lp =

  -1.2861e+09


lambda =

  -4.7855e+09


lp =

  -1.2861e+10


lambda =

  -4.7855e+09


lp =

  -1.2861e+10


lambda =

  -4.7855e+10


lp =

  -1.2861e+11


lambda =

  -4.7855e+10


lp =

  -1.2861e+11


lambda =

  -4.7855e+11


lp =

  -1.2861e+12


lambda =

  -4.7855e+11


lp =

  -1.2861e+12


lambda =

  -4.7855e+12


lp =

  -1.2861e+13


lambda =

  -4.7855e+12


lp =

  -1.2861e+13


lambda =

  -4.7855e+13


lp =

  -1.2861e+14


lambda =

  -4.7855e+13


lp =

  -1.2861e+14


lambda =

  -4.7855e+14


lp =

  -1.2861e+15


lambda =

  -4.7855e+14


lp =

  -1.2861e+15


lambda =

  -4.7855e+15


lp =

  -1.2861e+16


lambda =

  -4.7855e+15


lp =

  -1.2861e+16


lambda =

  -4.7855e+16


lp =

  -1.2861e+17


lambda =

  -4.7855e+16


lp =

  -1.2861e+17


lambda =

  -4.7855e+17


lp =

  -1.2861e+18


lambda =

  -4.7855e+17


lp =

  -1.2861e+18


lambda =

  -4.7855e+18


lp =

  -1.2861e+19


lambda =

  -4.7855e+18


lp =

  -1.2861e+19


lambda =

  -4.7855e+19


lp =

  -1.2861e+20


lambda =

  -4.7855e+19


lp =

  -1.2861e+20


lambda =

  -4.7855e+20


lp =

  -1.2861e+21


lambda =

  -4.7855e+20


lp =

  -1.2861e+21


lambda =

  -4.7855e+21


lp =

  -1.2861e+22


lambda =

  -4.7855e+21


lp =

  -1.2861e+22

         2         56     1.00000e+25    -1.28614e+22     2.68755e+00
Reached Maximum Number of Function Evaluations
Max magnitude of deformation in sample...3	0.083554
Updating template for sample...3

lambda =

     1


lp =

   5.1150e+04


lambda =

    1.0000


lp =

   5.1150e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1147e+04


lambda =

   2.0000e-06


lp =

   5.1147e+04

         1          4     1.77961e-04     5.11466e+04     3.23288e+00

lambda =

  -5.7566e-04


lp =

   5.1147e+04


lambda =

  -5.7366e-04


lp =

   5.1147e+04


lambda =

   -0.0058


lp =

   5.1147e+04


lambda =

   -0.0058


lp =

   5.1147e+04


lambda =

   -0.0576


lp =

   5.1146e+04


lambda =

   -0.0576


lp =

   5.1146e+04


lambda =

   -0.5757


lp =

   5.1145e+04


lambda =

   -0.5757


lp =

   5.1145e+04


lambda =

   -5.7566


lp =

   5.1128e+04


lambda =

   -5.7565


lp =

   5.1128e+04


lambda =

  -57.5656


lp =

   5.0960e+04


lambda =

  -57.5655


lp =

   5.0960e+04


lambda =

 -575.6562


lp =

   4.9286e+04


lambda =

 -575.6551


lp =

   4.9286e+04


lambda =

  -5.7566e+03


lp =

   3.2536e+04


lambda =

  -5.7566e+03


lp =

   3.2536e+04


lambda =

  -5.7566e+04


lp =

  -1.3496e+05


lambda =

  -5.7566e+04


lp =

  -1.3496e+05


lambda =

  -5.7566e+05


lp =

  -1.8099e+06


lambda =

  -5.7566e+05


lp =

  -1.8099e+06


lambda =

  -5.7566e+06


lp =

  -1.8559e+07


lambda =

  -5.7566e+06


lp =

  -1.8559e+07


lambda =

  -5.7566e+07


lp =

  -1.8605e+08


lambda =

  -5.7566e+07


lp =

  -1.8605e+08


lambda =

  -5.7566e+08


lp =

  -1.8610e+09


lambda =

  -5.7566e+08


lp =

  -1.8610e+09


lambda =

  -5.7566e+09


lp =

  -1.8610e+10


lambda =

  -5.7566e+09


lp =

  -1.8610e+10


lambda =

  -5.7566e+10


lp =

  -1.8610e+11


lambda =

  -5.7566e+10


lp =

  -1.8610e+11


lambda =

  -5.7566e+11


lp =

  -1.8610e+12


lambda =

  -5.7566e+11


lp =

  -1.8610e+12


lambda =

  -5.7566e+12


lp =

  -1.8610e+13


lambda =

  -5.7566e+12


lp =

  -1.8610e+13


lambda =

  -5.7566e+13


lp =

  -1.8610e+14


lambda =

  -5.7566e+13


lp =

  -1.8610e+14


lambda =

  -5.7566e+14


lp =

  -1.8610e+15


lambda =

  -5.7566e+14


lp =

  -1.8610e+15


lambda =

  -5.7566e+15


lp =

  -1.8610e+16


lambda =

  -5.7566e+15


lp =

  -1.8610e+16


lambda =

  -5.7566e+16


lp =

  -1.8610e+17


lambda =

  -5.7566e+16


lp =

  -1.8610e+17


lambda =

  -5.7566e+17


lp =

  -1.8610e+18


lambda =

  -5.7566e+17


lp =

  -1.8610e+18


lambda =

  -5.7566e+18


lp =

  -1.8610e+19


lambda =

  -5.7566e+18


lp =

  -1.8610e+19


lambda =

  -5.7566e+19


lp =

  -1.8610e+20


lambda =

  -5.7566e+19


lp =

  -1.8610e+20


lambda =

  -5.7566e+20


lp =

  -1.8610e+21


lambda =

  -5.7566e+20


lp =

  -1.8610e+21


lambda =

  -5.7566e+21


lp =

  -1.8610e+22


lambda =

  -5.7566e+21


lp =

  -1.8610e+22

         2         56     1.00000e+25    -1.86103e+22     3.23288e+00
Reached Maximum Number of Function Evaluations
Updating template for sample...3

lambda =

     1


lp =

   5.1150e+04


lambda =

    1.0000


lp =

   5.1150e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1147e+04


lambda =

   2.0000e-06


lp =

   5.1147e+04

         1          4     1.77961e-04     5.11466e+04     3.23288e+00

lambda =

  -5.7566e-04


lp =

   5.1147e+04


lambda =

  -5.7366e-04


lp =

   5.1147e+04


lambda =

   -0.0058


lp =

   5.1147e+04


lambda =

   -0.0058


lp =

   5.1147e+04


lambda =

   -0.0576


lp =

   5.1146e+04


lambda =

   -0.0576


lp =

   5.1146e+04


lambda =

   -0.5757


lp =

   5.1145e+04


lambda =

   -0.5757


lp =

   5.1145e+04


lambda =

   -5.7566


lp =

   5.1128e+04


lambda =

   -5.7565


lp =

   5.1128e+04


lambda =

  -57.5656


lp =

   5.0960e+04


lambda =

  -57.5655


lp =

   5.0960e+04


lambda =

 -575.6562


lp =

   4.9286e+04


lambda =

 -575.6551


lp =

   4.9286e+04


lambda =

  -5.7566e+03


lp =

   3.2536e+04


lambda =

  -5.7566e+03


lp =

   3.2536e+04


lambda =

  -5.7566e+04


lp =

  -1.3496e+05


lambda =

  -5.7566e+04


lp =

  -1.3496e+05


lambda =

  -5.7566e+05


lp =

  -1.8099e+06


lambda =

  -5.7566e+05


lp =

  -1.8099e+06


lambda =

  -5.7566e+06


lp =

  -1.8559e+07


lambda =

  -5.7566e+06


lp =

  -1.8559e+07


lambda =

  -5.7566e+07


lp =

  -1.8605e+08


lambda =

  -5.7566e+07


lp =

  -1.8605e+08


lambda =

  -5.7566e+08


lp =

  -1.8610e+09


lambda =

  -5.7566e+08


lp =

  -1.8610e+09


lambda =

  -5.7566e+09


lp =

  -1.8610e+10


lambda =

  -5.7566e+09


lp =

  -1.8610e+10


lambda =

  -5.7566e+10


lp =

  -1.8610e+11


lambda =

  -5.7566e+10


lp =

  -1.8610e+11


lambda =

  -5.7566e+11


lp =

  -1.8610e+12


lambda =

  -5.7566e+11


lp =

  -1.8610e+12


lambda =

  -5.7566e+12


lp =

  -1.8610e+13


lambda =

  -5.7566e+12


lp =

  -1.8610e+13


lambda =

  -5.7566e+13


lp =

  -1.8610e+14


lambda =

  -5.7566e+13


lp =

  -1.8610e+14


lambda =

  -5.7566e+14


lp =

  -1.8610e+15


lambda =

  -5.7566e+14


lp =

  -1.8610e+15


lambda =

  -5.7566e+15


lp =

  -1.8610e+16


lambda =

  -5.7566e+15


lp =

  -1.8610e+16


lambda =

  -5.7566e+16


lp =

  -1.8610e+17


lambda =

  -5.7566e+16


lp =

  -1.8610e+17


lambda =

  -5.7566e+17


lp =

  -1.8610e+18


lambda =

  -5.7566e+17


lp =

  -1.8610e+18


lambda =

  -5.7566e+18


lp =

  -1.8610e+19


lambda =

  -5.7566e+18


lp =

  -1.8610e+19


lambda =

  -5.7566e+19


lp =

  -1.8610e+20


lambda =

  -5.7566e+19


lp =

  -1.8610e+20


lambda =

  -5.7566e+20


lp =

  -1.8610e+21


lambda =

  -5.7566e+20


lp =

  -1.8610e+21


lambda =

  -5.7566e+21


lp =

  -1.8610e+22


lambda =

  -5.7566e+21


lp =

  -1.8610e+22

         2         56     1.00000e+25    -1.86103e+22     3.23288e+00
Reached Maximum Number of Function Evaluations
Max magnitude of deformation in sample...4	0.079176
Updating template for sample...4

lambda =

     1


lp =

   5.1141e+04


lambda =

    1.0000


lp =

   5.1141e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1137e+04


lambda =

   2.0000e-06


lp =

   5.1137e+04

         1          4     1.77945e-04     5.11369e+04     3.72831e+00

lambda =

  -6.6387e-04


lp =

   5.1137e+04


lambda =

  -6.6187e-04


lp =

   5.1137e+04


lambda =

   -0.0066


lp =

   5.1137e+04


lambda =

   -0.0066


lp =

   5.1137e+04


lambda =

   -0.0664


lp =

   5.1137e+04


lambda =

   -0.0664


lp =

   5.1137e+04


lambda =

   -0.6639


lp =

   5.1134e+04


lambda =

   -0.6639


lp =

   5.1134e+04


lambda =

   -6.6387


lp =

   5.1112e+04


lambda =

   -6.6387


lp =

   5.1112e+04


lambda =

  -66.3874


lp =

   5.0889e+04


lambda =

  -66.3873


lp =

   5.0889e+04


lambda =

 -663.8742


lp =

   4.8662e+04


lambda =

 -663.8728


lp =

   4.8662e+04


lambda =

  -6.6387e+03


lp =

   2.6386e+04


lambda =

  -6.6387e+03


lp =

   2.6386e+04


lambda =

  -6.6387e+04


lp =

  -1.9638e+05


lambda =

  -6.6387e+04


lp =

  -1.9638e+05


lambda =

  -6.6387e+05


lp =

  -2.4240e+06


lambda =

  -6.6387e+05


lp =

  -2.4240e+06


lambda =

  -6.6387e+06


lp =

  -2.4700e+07


lambda =

  -6.6387e+06


lp =

  -2.4700e+07


lambda =

  -6.6387e+07


lp =

  -2.4746e+08


lambda =

  -6.6387e+07


lp =

  -2.4746e+08


lambda =

  -6.6387e+08


lp =

  -2.4751e+09


lambda =

  -6.6387e+08


lp =

  -2.4751e+09


lambda =

  -6.6387e+09


lp =

  -2.4751e+10


lambda =

  -6.6387e+09


lp =

  -2.4751e+10


lambda =

  -6.6387e+10


lp =

  -2.4751e+11


lambda =

  -6.6387e+10


lp =

  -2.4751e+11


lambda =

  -6.6387e+11


lp =

  -2.4751e+12


lambda =

  -6.6387e+11


lp =

  -2.4751e+12


lambda =

  -6.6387e+12


lp =

  -2.4751e+13


lambda =

  -6.6387e+12


lp =

  -2.4751e+13


lambda =

  -6.6387e+13


lp =

  -2.4751e+14


lambda =

  -6.6387e+13


lp =

  -2.4751e+14


lambda =

  -6.6387e+14


lp =

  -2.4751e+15


lambda =

  -6.6387e+14


lp =

  -2.4751e+15


lambda =

  -6.6387e+15


lp =

  -2.4751e+16


lambda =

  -6.6387e+15


lp =

  -2.4751e+16


lambda =

  -6.6387e+16


lp =

  -2.4751e+17


lambda =

  -6.6387e+16


lp =

  -2.4751e+17


lambda =

  -6.6387e+17


lp =

  -2.4751e+18


lambda =

  -6.6387e+17


lp =

  -2.4751e+18


lambda =

  -6.6387e+18


lp =

  -2.4751e+19


lambda =

  -6.6387e+18


lp =

  -2.4751e+19


lambda =

  -6.6387e+19


lp =

  -2.4751e+20


lambda =

  -6.6387e+19


lp =

  -2.4751e+20


lambda =

  -6.6387e+20


lp =

  -2.4751e+21


lambda =

  -6.6387e+20


lp =

  -2.4751e+21


lambda =

  -6.6387e+21


lp =

  -2.4751e+22


lambda =

  -6.6387e+21


lp =

  -2.4751e+22

         2         56     1.00000e+25    -2.47513e+22     3.72831e+00
Reached Maximum Number of Function Evaluations
Updating template for sample...4

lambda =

     1


lp =

   5.1141e+04


lambda =

    1.0000


lp =

   5.1141e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1137e+04


lambda =

   2.0000e-06


lp =

   5.1137e+04

         1          4     1.77945e-04     5.11369e+04     3.72831e+00

lambda =

  -6.6387e-04


lp =

   5.1137e+04


lambda =

  -6.6187e-04


lp =

   5.1137e+04


lambda =

   -0.0066


lp =

   5.1137e+04


lambda =

   -0.0066


lp =

   5.1137e+04


lambda =

   -0.0664


lp =

   5.1137e+04


lambda =

   -0.0664


lp =

   5.1137e+04


lambda =

   -0.6639


lp =

   5.1134e+04


lambda =

   -0.6639


lp =

   5.1134e+04


lambda =

   -6.6387


lp =

   5.1112e+04


lambda =

   -6.6387


lp =

   5.1112e+04


lambda =

  -66.3874


lp =

   5.0889e+04


lambda =

  -66.3873


lp =

   5.0889e+04


lambda =

 -663.8742


lp =

   4.8662e+04


lambda =

 -663.8728


lp =

   4.8662e+04


lambda =

  -6.6387e+03


lp =

   2.6386e+04


lambda =

  -6.6387e+03


lp =

   2.6386e+04


lambda =

  -6.6387e+04


lp =

  -1.9638e+05


lambda =

  -6.6387e+04


lp =

  -1.9638e+05


lambda =

  -6.6387e+05


lp =

  -2.4240e+06


lambda =

  -6.6387e+05


lp =

  -2.4240e+06


lambda =

  -6.6387e+06


lp =

  -2.4700e+07


lambda =

  -6.6387e+06


lp =

  -2.4700e+07


lambda =

  -6.6387e+07


lp =

  -2.4746e+08


lambda =

  -6.6387e+07


lp =

  -2.4746e+08


lambda =

  -6.6387e+08


lp =

  -2.4751e+09


lambda =

  -6.6387e+08


lp =

  -2.4751e+09


lambda =

  -6.6387e+09


lp =

  -2.4751e+10


lambda =

  -6.6387e+09


lp =

  -2.4751e+10


lambda =

  -6.6387e+10


lp =

  -2.4751e+11


lambda =

  -6.6387e+10


lp =

  -2.4751e+11


lambda =

  -6.6387e+11


lp =

  -2.4751e+12


lambda =

  -6.6387e+11


lp =

  -2.4751e+12


lambda =

  -6.6387e+12


lp =

  -2.4751e+13


lambda =

  -6.6387e+12


lp =

  -2.4751e+13


lambda =

  -6.6387e+13


lp =

  -2.4751e+14


lambda =

  -6.6387e+13


lp =

  -2.4751e+14


lambda =

  -6.6387e+14


lp =

  -2.4751e+15


lambda =

  -6.6387e+14


lp =

  -2.4751e+15


lambda =

  -6.6387e+15


lp =

  -2.4751e+16


lambda =

  -6.6387e+15


lp =

  -2.4751e+16


lambda =

  -6.6387e+16


lp =

  -2.4751e+17


lambda =

  -6.6387e+16


lp =

  -2.4751e+17


lambda =

  -6.6387e+17


lp =

  -2.4751e+18


lambda =

  -6.6387e+17


lp =

  -2.4751e+18


lambda =

  -6.6387e+18


lp =

  -2.4751e+19


lambda =

  -6.6387e+18


lp =

  -2.4751e+19


lambda =

  -6.6387e+19


lp =

  -2.4751e+20


lambda =

  -6.6387e+19


lp =

  -2.4751e+20


lambda =

  -6.6387e+20


lp =

  -2.4751e+21


lambda =

  -6.6387e+20


lp =

  -2.4751e+21


lambda =

  -6.6387e+21


lp =

  -2.4751e+22


lambda =

  -6.6387e+21


lp =

  -2.4751e+22

         2         56     1.00000e+25    -2.47513e+22     3.72831e+00
Reached Maximum Number of Function Evaluations
Max magnitude of deformation in sample...5	0.090148
Updating template for sample...5

lambda =

     1


lp =

   5.1115e+04


lambda =

    1.0000


lp =

   5.1115e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1111e+04


lambda =

   2.0000e-06


lp =

   5.1111e+04

         1          4     1.77926e-04     5.11108e+04     4.31002e+00

lambda =

  -7.6745e-04


lp =

   5.1111e+04


lambda =

  -7.6545e-04


lp =

   5.1111e+04


lambda =

   -0.0077


lp =

   5.1111e+04


lambda =

   -0.0077


lp =

   5.1111e+04


lambda =

   -0.0767


lp =

   5.1110e+04


lambda =

   -0.0767


lp =

   5.1110e+04


lambda =

   -0.7675


lp =

   5.1108e+04


lambda =

   -0.7675


lp =

   5.1108e+04


lambda =

   -7.6745


lp =

   5.1078e+04


lambda =

   -7.6745


lp =

   5.1078e+04


lambda =

  -76.7454


lp =

   5.0780e+04


lambda =

  -76.7453


lp =

   5.0780e+04


lambda =

 -767.4544


lp =

   4.7803e+04


lambda =

 -767.4529


lp =

   4.7803e+04


lambda =

  -7.6745e+03


lp =

   1.8033e+04


lambda =

  -7.6745e+03


lp =

   1.8034e+04


lambda =

  -7.6745e+04


lp =

  -2.7966e+05


lambda =

  -7.6745e+04


lp =

  -2.7966e+05


lambda =

  -7.6745e+05


lp =

  -3.2566e+06


lambda =

  -7.6745e+05


lp =

  -3.2566e+06


lambda =

  -7.6745e+06


lp =

  -3.3026e+07


lambda =

  -7.6745e+06


lp =

  -3.3026e+07


lambda =

  -7.6745e+07


lp =

  -3.3072e+08


lambda =

  -7.6745e+07


lp =

  -3.3072e+08


lambda =

  -7.6745e+08


lp =

  -3.3077e+09


lambda =

  -7.6745e+08


lp =

  -3.3077e+09


lambda =

  -7.6745e+09


lp =

  -3.3077e+10


lambda =

  -7.6745e+09


lp =

  -3.3077e+10


lambda =

  -7.6745e+10


lp =

  -3.3077e+11


lambda =

  -7.6745e+10


lp =

  -3.3077e+11


lambda =

  -7.6745e+11


lp =

  -3.3077e+12


lambda =

  -7.6745e+11


lp =

  -3.3077e+12


lambda =

  -7.6745e+12


lp =

  -3.3077e+13


lambda =

  -7.6745e+12


lp =

  -3.3077e+13


lambda =

  -7.6745e+13


lp =

  -3.3077e+14


lambda =

  -7.6745e+13


lp =

  -3.3077e+14


lambda =

  -7.6745e+14


lp =

  -3.3077e+15


lambda =

  -7.6745e+14


lp =

  -3.3077e+15


lambda =

  -7.6745e+15


lp =

  -3.3077e+16


lambda =

  -7.6745e+15


lp =

  -3.3077e+16


lambda =

  -7.6745e+16


lp =

  -3.3077e+17


lambda =

  -7.6745e+16


lp =

  -3.3077e+17


lambda =

  -7.6745e+17


lp =

  -3.3077e+18


lambda =

  -7.6745e+17


lp =

  -3.3077e+18


lambda =

  -7.6745e+18


lp =

  -3.3077e+19


lambda =

  -7.6745e+18


lp =

  -3.3077e+19


lambda =

  -7.6745e+19


lp =

  -3.3077e+20


lambda =

  -7.6745e+19


lp =

  -3.3077e+20


lambda =

  -7.6745e+20


lp =

  -3.3077e+21


lambda =

  -7.6745e+20


lp =

  -3.3077e+21


lambda =

  -7.6745e+21


lp =

  -3.3077e+22


lambda =

  -7.6745e+21


lp =

  -3.3077e+22

         2         56     1.00000e+25    -3.30774e+22     4.31001e+00
Reached Maximum Number of Function Evaluations
Updating template for sample...5

lambda =

     1


lp =

   5.1115e+04


lambda =

    1.0000


lp =

   5.1115e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     0


lp =

   5.1111e+04


lambda =

   2.0000e-06


lp =

   5.1111e+04

         1          4     1.77926e-04     5.11108e+04     4.31002e+00

lambda =

  -7.6745e-04


lp =

   5.1111e+04


lambda =

  -7.6545e-04


lp =

   5.1111e+04


lambda =

   -0.0077


lp =

   5.1111e+04


lambda =

   -0.0077


lp =

   5.1111e+04


lambda =

   -0.0767


lp =

   5.1110e+04


lambda =

   -0.0767


lp =

   5.1110e+04


lambda =

   -0.7675


lp =

   5.1108e+04


lambda =

   -0.7675


lp =

   5.1108e+04


lambda =

   -7.6745


lp =

   5.1078e+04


lambda =

   -7.6745


lp =

   5.1078e+04


lambda =

  -76.7454


lp =

   5.0780e+04


lambda =

  -76.7453


lp =

   5.0780e+04


lambda =

 -767.4544


lp =

   4.7803e+04


lambda =

 -767.4529


lp =

   4.7803e+04


lambda =

  -7.6745e+03


lp =

   1.8033e+04


lambda =

  -7.6745e+03


lp =

   1.8034e+04


lambda =

  -7.6745e+04


lp =

  -2.7966e+05


lambda =

  -7.6745e+04


lp =

  -2.7966e+05


lambda =

  -7.6745e+05


lp =

  -3.2566e+06


lambda =

  -7.6745e+05


lp =

  -3.2566e+06


lambda =

  -7.6745e+06


lp =

  -3.3026e+07


lambda =

  -7.6745e+06


lp =

  -3.3026e+07


lambda =

  -7.6745e+07


lp =

  -3.3072e+08


lambda =

  -7.6745e+07


lp =

  -3.3072e+08


lambda =

  -7.6745e+08


lp =

  -3.3077e+09


lambda =

  -7.6745e+08


lp =

  -3.3077e+09


lambda =

  -7.6745e+09


lp =

  -3.3077e+10


lambda =

  -7.6745e+09


lp =

  -3.3077e+10


lambda =

  -7.6745e+10


lp =

  -3.3077e+11


lambda =

  -7.6745e+10


lp =

  -3.3077e+11


lambda =

  -7.6745e+11


lp =

  -3.3077e+12


lambda =

  -7.6745e+11


lp =

  -3.3077e+12


lambda =

  -7.6745e+12


lp =

  -3.3077e+13


lambda =

  -7.6745e+12


lp =

  -3.3077e+13


lambda =

  -7.6745e+13


lp =

  -3.3077e+14


lambda =

  -7.6745e+13


lp =

  -3.3077e+14


lambda =

  -7.6745e+14


lp =

  -3.3077e+15


lambda =

  -7.6745e+14


lp =

  -3.3077e+15


lambda =

  -7.6745e+15


lp =

  -3.3077e+16


lambda =

  -7.6745e+15


lp =

  -3.3077e+16


lambda =

  -7.6745e+16


lp =

  -3.3077e+17


lambda =

  -7.6745e+16


lp =

  -3.3077e+17


lambda =

  -7.6745e+17


lp =

  -3.3077e+18


lambda =

  -7.6745e+17


lp =

  -3.3077e+18


lambda =

  -7.6745e+18


lp =

  -3.3077e+19


lambda =

  -7.6745e+18


lp =

  -3.3077e+19


lambda =

  -7.6745e+19


lp =

  -3.3077e+20


lambda =

  -7.6745e+19


lp =

  -3.3077e+20


lambda =

  -7.6745e+20


lp =

  -3.3077e+21


lambda =

  -7.6745e+20


lp =

  -3.3077e+21


lambda =

  -7.6745e+21


lp =

  -3.3077e+22


lambda =

  -7.6745e+21


lp =

  -3.3077e+22

         2         56     1.00000e+25    -3.30774e+22     4.31001e+00
Reached Maximum Number of Function Evaluations
Iteration...2

------------------------------------------------------------------------
       Segmentation violation detected at Wed Jun  8 21:13:35 2016
------------------------------------------------------------------------

Configuration:
  Crash Decoding      : Disabled
  Crash Mode          : continue (default)
  Current Graphics Driver: Unknown software 
  Current Visual      : 0x21 (class 4, depth 24)
  Default Encoding    : UTF-8
  GNU C Library       : 2.19 stable
  Host Name           : imgpu3
  MATLAB Architecture : glnxa64
  MATLAB Root         : /usr/local/MATLAB/R2015b
  MATLAB Version      : 8.6.0.267246 (R2015b)
  OpenGL              : software
  Operating System    : Linux 3.19.0-51-generic #58~14.04.1-Ubuntu SMP Fri Feb 26 22:02:58 UTC 2016 x86_64
  Processor ID        : x86 Family 6 Model 62 Stepping 4, GenuineIntel
  Virtual Machine     : Java 1.7.0_60-b19 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode
  Window System       : The X.Org Foundation (11501000), display localhost:10.0

Fault Count: 1


Abnormal termination:
Segmentation violation

Register State (from fault):
  RAX = ffffffff80000000  RBX = 0000000000000000
  RCX = 0000000000000000  RDX = 0000000080000000
  RSP = 00007f3a21b450b0  RBP = 00007f3a21b453c0
  RSI = 00007f37d2e96750  RDI = 0000000000000000

   R8 = 00007f37d2e967b0   R9 = 00007f37d2e96790
  R10 = 00007f37d2e96770  R11 = 00007f37d2e96750
  R12 = 0000000080000000  R13 = 00007f37d0225860
  R14 = 0000000080000000  R15 = 00007f33d0225860

  RIP = 00007f38b52d8a83  EFL = 0000000000010242

   CS = 0033   FS = 0000   GS = 0000

Stack Trace (from fault):
[  0] 0x00007f38b52d8a83 /home/pai/Zie_Template_Estimation/C++/wendkernbuncompositionparallel.mexa64+00006787 mexFunction+00003667
[  1] 0x00007f3a2f653c4a     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00142410 mexRunMexFile+00000090
[  2] 0x00007f3a2f650244     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00127556
[  3] 0x00007f3a2f650de4     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00130532
[  4] 0x00007f3a33bf2dbd /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00724413 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00001549
[  5] 0x00007f3a33bf3250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[  6] 0x00007f3a2e26d8af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[  7] 0x00007f3a2e3917ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[  8] 0x00007f3a2e3ba196 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09974166
[  9] 0x00007f3a2e36f9f1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09669105
[ 10] 0x00007f3a2dfb6d6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 11] 0x00007f3a2dfa14c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 12] 0x00007f3a2dfb0075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 13] 0x00007f3a2e181033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 14] 0x00007f3a2e25f3bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08553404
[ 15] 0x00007f3a33bf2b31 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00723761 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00000897
[ 16] 0x00007f3a33bf3250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[ 17] 0x00007f3a2e26d8af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[ 18] 0x00007f3a2e3917ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[ 19] 0x00007f3a2e38747f /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09766015
[ 20] 0x00007f3a2e354981 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09558401
[ 21] 0x00007f3a2dfb6d6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 22] 0x00007f3a2dfa14c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 23] 0x00007f3a2dfb0075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 24] 0x00007f3a2e181033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 25] 0x00007f3a2e148c40 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07412800
[ 26] 0x00007f3a2e14b078 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07422072
[ 27] 0x00007f3a2e14b140 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07422272
[ 28] 0x00007f3a2e1c26bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07911100
[ 29] 0x00007f3a2e1c2b42 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07912258
[ 30] 0x00007f3a2f8872bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwbridge.so+00168636
[ 31] 0x00007f3a2f887ef7 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwbridge.so+00171767 _Z8mnParserv+00000823
[ 32] 0x00007f3a33ed9b4f   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00686927 _ZN11mcrInstance30mnParser_on_interpreter_threadEv+00000031
[ 33] 0x00007f3a33ec6443   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00607299
[ 34] 0x00007f3a33ec6a39   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00608825 _ZN5boost6detail11task_objectIvNS_3_bi6bind_tIvPFvRKNS_8functionIFvvEEEENS2_5list1INS2_5valueIS6_EEEEEEE6do_runEv+00000025
[ 35] 0x00007f3a33ec7f47   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00614215 _ZN5boost6detail9task_baseIvE3runEv+00000071
[ 36] 0x00007f3a33ec7fa7   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00614311
[ 37] 0x00007f3a33ec32fa   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00594682
[ 38] 0x00007f3a235af6b6   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwuix.so+00313014
[ 39] 0x00007f3a23595862   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwuix.so+00206946
[ 40] 0x00007f3a348590df /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03002591
[ 41] 0x00007f3a3485924c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03002956
[ 42] 0x00007f3a3485ad9f /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03009951
[ 43] 0x00007f3a3485b84c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03012684 _Z25svWS_ProcessPendingEventsiib+00000092
[ 44] 0x00007f3a33ec39b8   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00596408
[ 45] 0x00007f3a33ec3cd4   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00597204
[ 46] 0x00007f3a33eaffed   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00516077
[ 47] 0x00007f3a3ca37182              /lib/x86_64-linux-gnu/libpthread.so.0+00033154
[ 48] 0x00007f3a3c76447d                    /lib/x86_64-linux-gnu/libc.so.6+01025149 clone+00000109
[ 49] 0x0000000000000000                                   <unknown-module>+00000000


This error was detected while a MEX-file was running. If the MEX-file
is not an official MathWorks function, please examine its source code
for errors. Please consult the External Interfaces Guide for information
on debugging MEX-files.

If this problem is reproducible, please submit a Service Request via:
    http://www.mathworks.com/support/contact_us/

A technical support engineer might contact you with further information.

Thank you for your help.**Iteration...1
Finished step   -1  Threshold: 1.02897
Finished step    0  Threshold: 1.03307
Finished step    1  Threshold: 1.0112
Finished step    2  Threshold: 1.01011
Finished step    3  Threshold: 1.01385
Finished step    4  Threshold: 1.01366
Finished step    5  Threshold: 1.01063

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.063580
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	0.081487
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	0.101518
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	0.106813
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	0.103674
Updating template for sample...5
Updating template for sample...5

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

     1


lp =

  -9.0002e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    1.0000


lp =

  -9.0002e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

     2


lp =

  -9.0011e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0000


lp =

  -9.0011e+04

         1          4     8.89868e-05    -9.00105e+04     1.12892e+01

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0010


lp =

  -9.0011e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0010


lp =

  -9.0011e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0101


lp =

  -9.0011e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0101


lp =

  -9.0011e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.1006


lp =

  -9.0012e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.1006


lp =

  -9.0012e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    3.0056


lp =

  -9.0025e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    3.0056


lp =

  -9.0025e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   12.0560


lp =

  -9.0409e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   12.0560


lp =

  -9.0409e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

  102.5601


lp =

  -1.1969e+05


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

  102.5603


lp =

  -1.1969e+05


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.0076e+03


lp =

  -2.9554e+06


ans =

     1


ans =

     1


ans =

     1


ans =

     1

{Operation terminated by user during logPosteriorLambda (line 54)


In autoGrad (line 20)
		diff(j,1) = funObj(x + mu*e_j,varargin{:});

In WolfeLineSearch (line 114)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.00935
Finished step    0  Threshold: 1.01075
Finished step    1  Threshold: 1.02263
Finished step    2  Threshold: 1.01444
Finished step    3  Threshold: 1.0122
Finished step    4  Threshold: 1.03822
Finished step    5  Threshold: 1.02909

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.052160
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	0.071359
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	0.076541
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	0.083130
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	0.101881
Updating template for sample...5
Updating template for sample...5

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

     1


lp =

  -9.0054e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    1.0000


lp =

  -9.0054e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

     2


lp =

  -9.0061e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    2.0000


lp =

  -9.0061e+04

         1          4     8.89915e-05    -9.00611e+04     1.00921e+01

ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    3.5000


lp =

  -9.0082e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

    3.5000


lp =

  -9.0082e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   17.0000


lp =

  -9.0780e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   17.0000


lp =

  -9.0780e+04


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

  151.9998


lp =

  -1.4834e+05


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

  152.0001


lp =

  -1.4834e+05


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5020e+03


lp =

  -5.7820e+06


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5020e+03


lp =

  -5.7820e+06


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5002e+04


lp =

  -5.6792e+08


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5002e+04


lp =

  -5.6792e+08


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5000e+05


lp =

  -5.6770e+10


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


ans =

     1


lambda =

   1.5000e+05


lp =

  -5.6770e+10


ans =

     1


ans =

     1


ans =

     1


ans =

     1

{Operation terminated by user during logPosteriorLambda (line 32)


In autoGrad (line 14)
	f = funObj(x,varargin{:});

In WolfeLineSearch (line 114)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Parallel pool using the 'local' profile is shutting down.
Starting parallel pool (parpool) using the 'local' profile ... connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.48038
Finished step    0  Threshold: 1.29901
Finished step    1  Threshold: 1.25429
Finished step    2  Threshold: 1.40855
Finished step    3  Threshold: 1.19077
Finished step    4  Threshold: 1.09618
Finished step    5  Threshold: 1.16499

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.079375
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	0.086035
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	0.099433
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	0.099594
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	0.109791
Updating template for sample...5
Updating template for sample...5

ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

     1


lp =

  -8.8719e+04


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

    1.0000


lp =

  -8.8719e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

     2


lp =

  -8.9324e+04


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

    2.0000


lp =

  -8.9324e+04

         1          4     8.89699e-05    -8.93235e+04     1.55626e+01

ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

   17.5626


lp =

  -9.0508e+04


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

   17.5626


lp =

  -9.0508e+04


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

  157.6255


lp =

  -1.8597e+05


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


lambda =

  157.6258


lp =

  -1.8597e+05


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258


ans =

  2.9077e-258

{Operation terminated by user during logPosteriorLambda (line 30)


In autoGrad (line 14)
	f = funObj(x,varargin{:});

In WolfeLineSearch (line 114)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers
see: http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -1  Threshold: 1.29078
Finished step    0  Threshold: 1.288
Finished step    1  Threshold: 1.10462
Finished step    2  Threshold: 1.20899
Finished step    3  Threshold: 1.25235
Finished step    4  Threshold: 1.15829
Finished step    5  Threshold: 1.15681

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	0.075130
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	0.090139
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	0.082899
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	0.104513
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	0.114163
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -8.8882e+04


lambda =

    1.0000


lp =

  -8.8882e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -Inf


lambda =

    2.0000


lp =

  -Inf


lambda =

    1.5000


lp =

  -Inf


lambda =

    1.5000


lp =

  -Inf


lambda =

    1.2500


lp =

  -Inf


lambda =

    1.2500


lp =

  -Inf


lambda =

    1.1250


lp =

  -Inf


lambda =

    1.1250


lp =

  -Inf


lambda =

    1.0625


lp =

  -8.9563e+04


lambda =

    1.0625


lp =

  -8.9563e+04

         1         12     5.56142e-06    -8.95630e+04     1.05778e+04
Reached Maximum Number of Function Evaluations

ans =

     0

Iteration...2

------------------------------------------------------------------------
       Segmentation violation detected at Thu Jun  9 00:04:57 2016
------------------------------------------------------------------------

Configuration:
  Crash Decoding      : Disabled
  Crash Mode          : continue (default)
  Current Graphics Driver: Unknown software 
  Current Visual      : 0x21 (class 4, depth 24)
  Default Encoding    : UTF-8
  GNU C Library       : 2.19 stable
  Host Name           : imgpu3
  MATLAB Architecture : glnxa64
  MATLAB Root         : /usr/local/MATLAB/R2015b
  MATLAB Version      : 8.6.0.267246 (R2015b)
  OpenGL              : software
  Operating System    : Linux 3.19.0-51-generic #58~14.04.1-Ubuntu SMP Fri Feb 26 22:02:58 UTC 2016 x86_64
  Processor ID        : x86 Family 6 Model 62 Stepping 4, GenuineIntel
  Virtual Machine     : Java 1.7.0_60-b19 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode
  Window System       : The X.Org Foundation (11501000), display localhost:10.0

Fault Count: 1


Abnormal termination:
Segmentation violation

Register State (from fault):
  RAX = ffffffff80000000  RBX = 0000000000000000
  RCX = 0000000000000000  RDX = 0000000080000000
  RSP = 00007facc884a0b0  RBP = 00007facc884a3c0
  RSI = 00007faacce0f770  RDI = 0000000000000000

   R8 = 00007faacce0f700   R9 = 00007fac52381a60
  R10 = 00007faacce0f7a0  R11 = 00007faacce0f770
  R12 = 0000000080000000  R13 = 00007faacce22ac0
  R14 = 0000000080000000  R15 = 00007fa6cce22ac0

  RIP = 00007fab627b4a83  EFL = 0000000000010202

   CS = 0033   FS = 0000   GS = 0000

Stack Trace (from fault):
[  0] 0x00007fab627b4a83 /home/pai/Zie_Template_Estimation/C++/wendkernbuncompositionparallel.mexa64+00006787 mexFunction+00003667
[  1] 0x00007facd228ac4a     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00142410 mexRunMexFile+00000090
[  2] 0x00007facd2287244     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00127556
[  3] 0x00007facd2287de4     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00130532
[  4] 0x00007facd6829dbd /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00724413 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00001549
[  5] 0x00007facd682a250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[  6] 0x00007facd0ea48af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[  7] 0x00007facd0fc87ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[  8] 0x00007facd0ff1196 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09974166
[  9] 0x00007facd0fa69f1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09669105
[ 10] 0x00007facd0bedd6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 11] 0x00007facd0bd84c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 12] 0x00007facd0be7075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 13] 0x00007facd0db8033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 14] 0x00007facd0e963bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08553404
[ 15] 0x00007facd6829b31 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00723761 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00000897
[ 16] 0x00007facd682a250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[ 17] 0x00007facd0ea48af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[ 18] 0x00007facd0fc87ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[ 19] 0x00007facd0fbe47f /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09766015
[ 20] 0x00007facd0f8b981 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09558401
[ 21] 0x00007facd0bedd6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 22] 0x00007facd0bd84c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 23] 0x00007facd0be7075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 24] 0x00007facd0db8033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 25] 0x00007facd0d7fc40 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07412800
[ 26] 0x00007facd0d82078 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07422072
[ 27] 0x00007facd0d82140 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07422272
[ 28] 0x00007facd0df96bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07911100
[ 29] 0x00007facd0df9b42 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07912258
[ 30] 0x00007facd24be2bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwbridge.so+00168636
[ 31] 0x00007facd24beef7 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwbridge.so+00171767 _Z8mnParserv+00000823
[ 32] 0x00007facd6b10b4f   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00686927 _ZN11mcrInstance30mnParser_on_interpreter_threadEv+00000031
[ 33] 0x00007facd6afd443   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00607299
[ 34] 0x00007facd6afda39   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00608825 _ZN5boost6detail11task_objectIvNS_3_bi6bind_tIvPFvRKNS_8functionIFvvEEEENS2_5list1INS2_5valueIS6_EEEEEEE6do_runEv+00000025
[ 35] 0x00007facd6afef47   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00614215 _ZN5boost6detail9task_baseIvE3runEv+00000071
[ 36] 0x00007facd6afefa7   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00614311
[ 37] 0x00007facd6afa2fa   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00594682
[ 38] 0x00007facca2b46b6   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwuix.so+00313014
[ 39] 0x00007facca29a862   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwuix.so+00206946
[ 40] 0x00007facd74900df /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03002591
[ 41] 0x00007facd749024c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03002956
[ 42] 0x00007facd7491d9f /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03009951
[ 43] 0x00007facd749284c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwservices.so+03012684 _Z25svWS_ProcessPendingEventsiib+00000092
[ 44] 0x00007facd6afa9b8   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00596408
[ 45] 0x00007facd6afacd4   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00597204
[ 46] 0x00007facd6ae6fed   /usr/local/MATLAB/R2015b/bin/glnxa64/libmwmcr.so+00516077
[ 47] 0x00007facdf66e182              /lib/x86_64-linux-gnu/libpthread.so.0+00033154
[ 48] 0x00007facdf39b47d                    /lib/x86_64-linux-gnu/libc.so.6+01025149 clone+00000109
[ 49] 0x0000000000000000                                   <unknown-module>+00000000


This error was detected while aIteration...1
Finished step   -4  Threshold: 1.606
Finished step   -3  Threshold: 1.58158
Finished step   -2  Threshold: 2.33701
Finished step   -1  Threshold: 1.18251
Finished step    0  Threshold: 1.25675
  Sample rejected    1.  Threshold: 0.74136
Finished step    2  Threshold: 1.86798
Finished step    3  Threshold: 0.957128
Finished step    4  Threshold: 1.40524
Finished step    5  Threshold: 0.950366

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.374157
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.356179
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.430951
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.387471
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.393717
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -5.6446e+04


dlp =

 -762.8972

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -5.1785e+04


dlp =

 -482.0972


lambda =

    1.5000


lp =

  -5.3785e+04


dlp =

 -575.6972


lambda =

    1.2500


lp =

  -5.5001e+04


dlp =

 -650.5772


lambda =

    1.1250


lp =

  -5.5689e+04


dlp =

 -700.4972


lambda =

    1.0625


lp =

  -5.6058e+04


dlp =

 -729.8619


lambda =

    1.0312


lp =

  -5.6250e+04


dlp =

 -745.8790


lambda =

    1.0156


lp =

  -5.6347e+04


dlp =

 -754.2572


lambda =

    1.0078


lp =

  -5.6397e+04


dlp =

 -758.5437


lambda =

    1.0039


lp =

  -5.6422e+04


dlp =

 -760.7120


lambda =

    1.0020


lp =

  -5.6434e+04


dlp =

 -761.8025


lambda =

    1.0010


lp =

  -5.6440e+04


dlp =

 -762.3493


lambda =

    1.0005


lp =

  -5.6443e+04


dlp =

 -762.6231


lambda =

    1.0002


lp =

  -5.6445e+04


dlp =

 -762.7601


lambda =

    1.0001


lp =

  -5.6446e+04


dlp =

 -762.8287


lambda =

    1.0001


lp =

  -5.6446e+04


dlp =

 -762.8629


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8801


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8886


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8929


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8951


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8961


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8967


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8969


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8971


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8971


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8972


lambda =

    1.0000


lp =

  -5.6446e+04


dlp =

 -762.8972

         1         27     0.00000e+00    -5.64465e+04     7.62897e+02
Step Size below progTol

ans =

     0

Iteration...2
Finished step   -4  Threshold: 2.83998
Finished step   -3  Threshold: 1.61454
Finished step   -2  Threshold: 1.99726
Finished step   -1  Threshold: 1.2125
Finished step    0  Threshold: 1.39412
Finished step    1  Threshold: 1.74747
Finished step    2  Threshold: 1.12407
Finished step    3  Threshold: 0.993468
Finished step    4  Threshold: 1.03093
Finished step    5  Threshold: 0.640741

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.271854
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.388387
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.662577
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.750363
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.909567
Updating template for sample...5
Updating template for sample...5

lambda =

    0.1000


lp =

  -7.0056e+04


dlp =

  -5.8554e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.1000


lp =

  -5.5685e+04


dlp =

 -749.9643


lambda =

    0.6000


lp =

  -5.9542e+04


dlp =

  -1.1754e+03


lambda =

    0.3500


lp =

  -6.2795e+04


dlp =

  -1.8440e+03


lambda =

    0.2250


lp =

  -6.5389e+04


dlp =

  -2.7354e+03


lambda =

    0.1625


lp =

  -6.7273e+04


dlp =

  -3.6954e+03


lambda =

    0.1313


lp =

  -6.8501e+04


dlp =

  -4.5183e+03


lambda =

    0.1156


lp =

  -6.9227e+04


dlp =

  -5.0965e+03


lambda =

    0.1078


lp =

  -6.9627e+04


dlp =

  -5.4485e+03


lambda =

    0.1039


lp =

  -6.9838e+04


dlp =

  -5.6443e+03


lambda =

    0.1020


lp =

  -6.9946e+04


dlp =

  -5.7478e+03


lambda =

    0.1010


lp =

  -7.0001e+04


dlp =

  -5.8011e+03


lambda =

    0.1005


lp =

  -7.0029e+04


dlp =

  -5.8281e+03


lambda =

    0.1002


lp =

  -7.0042e+04


dlp =

  -5.8417e+03


lambda =

    0.1001


lp =

  -7.0049e+04


dlp =

  -5.8486e+03


lambda =

    0.1001


lp =

  -7.0053e+04


dlp =

  -5.8520e+03


lambda =

    0.1000


lp =

  -7.0055e+04


dlp =

  -5.8537e+03


lambda =

    0.1000


lp =

  -7.0055e+04


dlp =

  -5.8546e+03


lambda =

    0.1000


lp =

  -7.0056e+04


dlp =

  -5.8550e+03


lambda =

    0.1000


lp =

  -7.0056e+04


dlp =

  -5.8552e+03

{Operation terminated by user during logdet (line 86)


In logPosteriorLambda (line 49)
        logdetC = logdet(C,'chol');

In WolfeLineSearch (line 194)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples, ssd);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3


ans =

    12    13    12     3

Parallel pool using the 'local' profile is shutting down.
Starting parallel pool (parpool) using the 'local' profile ... connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 2.23608
Finished step   -3  Threshold: 1.32575
Finished step   -2  Threshold: 1.6171
Finished step   -1  Threshold: 0.821573
Finished step    0  Threshold: 1.33305
  Sample rejected    1.  Threshold: 0.809425
Finished step    2  Threshold: 1.47227
Finished step    3  Threshold: 0.812657
Finished step    4  Threshold: 1.00007
Finished step    5  Threshold: 1.30142

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.158424
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.539602
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.504691
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.559912
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.810228
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -5.6449e+04


dlp =

 -767.2248

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -5.1789e+04


dlp =

 -486.4248


lambda =

    1.5000


lp =

  -5.3788e+04


dlp =

 -580.0248


lambda =

    1.2500


lp =

  -5.5004e+04


dlp =

 -654.9048


lambda =

    1.1250


lp =

  -5.5691e+04


dlp =

 -704.8248


lambda =

    1.0625


lp =

  -5.6060e+04


dlp =

 -734.1895


lambda =

    1.0312


lp =

  -5.6252e+04


dlp =

 -750.2066


lambda =

    1.0156


lp =

  -5.6350e+04


dlp =

 -758.5848


lambda =

    1.0078


lp =

  -5.6399e+04


dlp =

 -762.8713


lambda =

    1.0039


lp =

  -5.6424e+04


dlp =

 -765.0396


lambda =

    1.0020


lp =

  -5.6436e+04


dlp =

 -766.1301


lambda =

    1.0010


lp =

  -5.6443e+04


dlp =

 -766.6769


lambda =

    1.0005


lp =

  -5.6446e+04


dlp =

 -766.9507


lambda =

    1.0002


lp =

  -5.6447e+04


dlp =

 -767.0878


lambda =

    1.0001


lp =

  -5.6448e+04


dlp =

 -767.1563


lambda =

    1.0001


lp =

  -5.6448e+04


dlp =

 -767.1906


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2077


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2163


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2205


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2227


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2238


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2243


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2246


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2247


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2248


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2248


lambda =

    1.0000


lp =

  -5.6449e+04


dlp =

 -767.2248

         1         27     0.00000e+00    -5.64488e+04     7.67225e+02
Step Size below progTol

ans =

     0

Iteration...2
Finished step   -4  Threshold: 2.06679
Finished step   -3  Threshold: 1.69831
Finished step   -2  Threshold: 1.80039
Finished step   -1  Threshold: 1.70094
  Sample rejected    0.  Threshold: 0.707348
Finished step    1  Threshold: 1.38143
Finished step    2  Threshold: 1.18019
Finished step    3  Threshold: 1.07093
Finished step    4  Threshold: 1.45328
Finished step    5  Threshold: 1.53411

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.065147
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.204306
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.563465
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.645140
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	2.007304
Updating template for sample...5
Updating template for sample...5

lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8183e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.1000


lp =

  -5.5836e+04


dlp =

 -712.8155


lambda =

    0.6000


lp =

  -5.9624e+04


dlp =

  -1.1383e+03


lambda =

    0.3500


lp =

  -6.2843e+04


dlp =

  -1.8068e+03


lambda =

    0.2250


lp =

  -6.5420e+04


dlp =

  -2.6983e+03


lambda =

    0.1625


lp =

  -6.7295e+04


dlp =

  -3.6583e+03


lambda =

    0.1313


lp =

  -6.8519e+04


dlp =

  -4.4811e+03


lambda =

    0.1156


lp =

  -6.9243e+04


dlp =

  -5.0594e+03


lambda =

    0.1078


lp =

  -6.9642e+04


dlp =

  -5.4113e+03


lambda =

    0.1039


lp =

  -6.9852e+04


dlp =

  -5.6071e+03


lambda =

    0.1020


lp =

  -6.9960e+04


dlp =

  -5.7107e+03


lambda =

    0.1010


lp =

  -7.0015e+04


dlp =

  -5.7640e+03


lambda =

    0.1005


lp =

  -7.0042e+04


dlp =

  -5.7910e+03


lambda =

    0.1002


lp =

  -7.0056e+04


dlp =

  -5.8046e+03


lambda =

    0.1001


lp =

  -7.0063e+04


dlp =

  -5.8114e+03


lambda =

    0.1001


lp =

  -7.0067e+04


dlp =

  -5.8148e+03


lambda =

    0.1000


lp =

  -7.0068e+04


dlp =

  -5.8166e+03


lambda =

    0.1000


lp =

  -7.0069e+04


dlp =

  -5.8174e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8178e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8181e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8182e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8182e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8182e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8183e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8183e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8183e+03


lambda =

    0.1000


lp =

  -7.0070e+04


dlp =

  -5.8183e+03

         1         27     0.00000e+00    -7.00700e+04     5.81827e+03
Step Size below progTol

ans =

     0

Iteration...3
Finished step   -4  Threshold: 1.66766
Finished step   -3  Threshold: 1.60767
Finished step   -2  Threshold: 1.28214
Finished step   -1  Threshold: 1.33148
Finished step    0  Threshold: 1.52874
Finished step    1  Threshold: 0.837789
Finished step    2  Threshold: 1.34215
Finished step    3  Threshold: 1.17515
Finished step    4  Threshold: 1.1444
Finished step    5  Threshold: 1.51442

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.173883
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.384192
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.351436
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.560979
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.508660
Updating template for sample...5
Updating template for sample...5

lambda =

    0.0100


lp =

  -8.2627e+04


dlp =

  -5.6361e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0100


lp =

  -5.5905e+04


dlp =

 -756.8943


lambda =

    0.5100


lp =

  -6.0144e+04


dlp =

  -1.3020e+03


lambda =

    0.2600


lp =

  -6.4128e+04


dlp =

  -2.3609e+03


lambda =

    0.1350


lp =

  -6.7910e+04


dlp =

  -4.3609e+03


lambda =

    0.0725


lp =

  -7.1451e+04


dlp =

  -7.9471e+03


lambda =

    0.0412


lp =

  -7.4643e+04


dlp =

  -1.3815e+04


lambda =

    0.0256


lp =

  -7.7330e+04


dlp =

  -2.2117e+04


lambda =

    0.0178


lp =

  -7.9378e+04


dlp =

  -3.1729e+04


lambda =

    0.0139


lp =

  -8.0772e+04


dlp =

  -4.0586e+04


lambda =

    0.0120


lp =

  -8.1623e+04


dlp =

  -4.7184e+04


lambda =

    0.0110


lp =

  -8.2103e+04


dlp =

  -5.1364e+04


lambda =

    0.0105


lp =

  -8.2359e+04


dlp =

  -5.3746e+04


lambda =

    0.0102


lp =

  -8.2491e+04


dlp =

  -5.5022e+04


lambda =

    0.0101


lp =

  -8.2558e+04


dlp =

  -5.5684e+04


lambda =

    0.0101


lp =

  -8.2592e+04


dlp =

  -5.6020e+04


lambda =

    0.0100


lp =

  -8.2609e+04


dlp =

  -5.6190e+04


lambda =

    0.0100


lp =

  -8.2618e+04


dlp =

  -5.6275e+04


lambda =

    0.0100


lp =

  -8.2622e+04


dlp =

  -5.6318e+04


lambda =

    0.0100


lp =

  -8.2624e+04


dlp =

  -5.6339e+04


lambda =

    0.0100


lp =

  -8.2626e+04


dlp =

  -5.6350e+04


lambda =

    0.0100


lp =

  -8.2626e+04


dlp =

  -5.6355e+04


lambda =

    0.0100


lp =

  -8.2626e+04


dlp =

  -5.6358e+04


lambda =

    0.0100


lp =

  -8.2626e+04


dlp =

  -5.6360e+04


lambda =

    0.0100


lp =

  -8.2627e+04


dlp =

  -5.6360e+04


lambda =

    0.0100


lp =

  -8.2627e+04


dlp =

  -5.6361e+04


lambda =

    0.0100


lp =

  -8.2627e+04


dlp =

  -5.6361e+04

         1         27     0.00000e+00    -8.26266e+04     5.63609e+04
Step Size below progTol

ans =

     0

Iteration...4
Finished step   -4  Threshold: 1.69357
Finished step   -3  Threshold: 1.34364
Finished step   -2  Threshold: 1.53342
{Operation terminated by user during blkdiag (line 44)


In DlogPosterior (line 44)
    C = sparse(blkdiag(C,C,C));

In hmc (line 182)
    p = p - epsilon*feval(gradf, x, varargin{:});

In EMTemplate (line 47)
    [samples] = hmc(@logPosterior, p, options, @DlogPosterior, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, lambda, voxelSize, sZ, freeformParams{1});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3


ans =

    33    39    33     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
{Operation terminated by user during blkdiag (line 44)


In logPosterior (line 37)
    C = sparse(blkdiag(C,C,C));

In hmc (line 149)
Eold = feval(f, x, varargin{:});	% Evaluate starting energy.

In EMTemplate (line 47)
    [samples] = hmc(@logPosterior, p, options, @DlogPosterior, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, lambda, voxelSize, sZ, freeformParams{1});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 1.26164
Finished step   -3  Threshold: 1.30129
Finished step   -2  Threshold: 0.803676
Finished step   -1  Threshold: 1.32549
Finished step    0  Threshold: 1.52229
Finished step    1  Threshold: 0.944464
  Sample rejected    2.  Threshold: 0.825569
  Sample rejected    3.  Threshold: 0.972187
Finished step    4  Threshold: 1.31095
Finished step    5  Threshold: 1.9484

Fraction of samples rejected:  0.4
Max magnitude of deformation in sample...1	1.393247
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.393247
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.393247
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.433094
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.541840
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -7.3531e+04


dlp =

  -3.9867e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -4.8209e+04


dlp =

  -2.3991e+03

{Operation terminated by user during logPosteriorLambda (line 45)


In WolfeLineSearch (line 194)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples, ssd);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
{Operation terminated by user during images.internal.morphop (line 99)


In imdilate (line 120)
B = images.internal.morphop(A,se,'dilate',mfilename,varargin{:});

In reduceeval (line 11)
dilated = imdilate(seg, se);

In mainRun (line 72)
points=reduceeval(points,atlases~=0,6,voxelSize);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
{Undefined function or variable 's'.

Error in logPosterior (line 35)
    [~,~,C] = wendsquarednorm(freeformParams{s}{j}{end},ffSpacing,ffSupportCov, 1);

Error in hmc (line 149)
Eold = feval(f, x, varargin{:});	% Evaluate starting energy.

Error in EMTemplate (line 47)
    [samples] = hmc(@logPosterior, p, options, @DlogPosterior, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, lambda, voxelSize, sZ, freeformParams{1});

Error in mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3


ans =

    21    24    21     3

Parallel pool using the 'local' profile is shutting down.
Starting parallel pool (parpool) using the 'local' profile ... connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 0.991777
Finished step   -3  Threshold: 1.06458
Finished step   -2  Threshold: 1.36193
Finished step   -1  Threshold: 0.977393
  Sample rejected    0.  Threshold: 0.704393
Finished step    1  Threshold: 1.10614
Finished step    2  Threshold: 1.31585
Finished step    3  Threshold: 1.13192
Finished step    4  Threshold: 0.605125
  Sample rejected    5.  Threshold: 0.844288

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.270393
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.335273
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.537550
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.709041
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.709041
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -7.3590e+04


dlp =

  -3.9514e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -4.8328e+04


dlp =

  -2.3638e+03


lambda =

    1.5000


lp =

  -5.9089e+04


dlp =

  -2.8930e+03


lambda =

    1.2500


lp =

  -6.5691e+04


dlp =

  -3.3164e+03


lambda =

    1.1250


lp =

  -6.9444e+04


dlp =

  -3.5986e+03


lambda =

    1.0625


lp =

  -7.1462e+04


dlp =

  -3.7647e+03


lambda =

    1.0312


lp =

  -7.2511e+04


dlp =

  -3.8552e+03


lambda =

    1.0156


lp =

  -7.3047e+04


dlp =

  -3.9026e+03


lambda =

    1.0078


lp =

  -7.3318e+04


dlp =

  -3.9268e+03


lambda =

    1.0039


lp =

  -7.3454e+04


dlp =

  -3.9391e+03


lambda =

    1.0020


lp =

  -7.3522e+04


dlp =

  -3.9452e+03


lambda =

    1.0010


lp =

  -7.3556e+04


dlp =

  -3.9483e+03


lambda =

    1.0005


lp =

  -7.3573e+04


dlp =

  -3.9499e+03


lambda =

    1.0002


lp =

  -7.3582e+04


dlp =

  -3.9507e+03


lambda =

    1.0001


lp =

  -7.3586e+04


dlp =

  -3.9510e+03


lambda =

    1.0001


lp =

  -7.3588e+04


dlp =

  -3.9512e+03


lambda =

    1.0000


lp =

  -7.3589e+04


dlp =

  -3.9513e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03


lambda =

    1.0000


lp =

  -7.3590e+04


dlp =

  -3.9514e+03

         1         27     0.00000e+00    -7.35901e+04     3.95143e+03
Step Size below progTol

ans =

     0

Iteration...2
Finished step   -4  Threshold: 1.47799
Finished step   -3  Threshold: 1.07319
Finished step   -2  Threshold: 1.36066
Finished step   -1  Threshold: 1.15202
Finished step    0  Threshold: 0.620987
Finished step    1  Threshold: 1.22564
Finished step    2  Threshold: 1.1614
Finished step    3  Threshold: 0.584896
  Sample rejected    4.  Threshold: 0.641019
Finished step    5  Threshold: 1.00155

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.309397
Updating template for sample...1
Starting parallel pool (parpool) using the 'local' profile ... IdleTimeout has been reached.
Parallel pool using the 'local' profile is shutting down.
connected to 12 workers.
Updating template for sample...1
Max magnitude of deformation in sample...2	1.528086
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.729013
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.729013
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.897602
Updating template for sample...5
Updating template for sample...5

lambda =

    0.1000


lp =

  -1.4953e+05


dlp =

  -3.2717e+04

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.1000


lp =

  -6.9173e+04


dlp =

  -3.8512e+03


lambda =

    0.6000


lp =

  -9.0530e+04


dlp =

  -6.2567e+03


lambda =

    0.3500


lp =

  -1.0870e+05


dlp =

  -1.0037e+04


lambda =

    0.2250


lp =

  -1.2326e+05


dlp =

  -1.5077e+04


lambda =

    0.1625


lp =

  -1.3385e+05


dlp =

  -2.0504e+04


lambda =

    0.1313


lp =

  -1.4077e+05


dlp =

  -2.5157e+04


lambda =

    0.1156


lp =

  -1.4486e+05


dlp =

  -2.8426e+04


lambda =

    0.1078


lp =

  -1.4711e+05


dlp =

  -3.0416e+04


lambda =

    0.1039


lp =

  -1.4830e+05


dlp =

  -3.1523e+04


lambda =

    0.1020


lp =

  -1.4891e+05


dlp =

  -3.2108e+04


lambda =

    0.1010


lp =

  -1.4922e+05


dlp =

  -3.2410e+04


lambda =

    0.1005


lp =

  -1.4938e+05


dlp =

  -3.2562e+04


lambda =

    0.1002


lp =

  -1.4945e+05


dlp =

  -3.2639e+04


lambda =

    0.1001


lp =

  -1.4949e+05


dlp =

  -3.2678e+04


lambda =

    0.1001


lp =

  -1.4951e+05


dlp =

  -3.2697e+04

{Operation terminated by user during blkdiag (line 44)


In logPosteriorLambda (line 45)
        C = sparse(blkdiag(C,C,C));

In WolfeLineSearch (line 194)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples, ssd);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 1.38714
Finished step   -3  Threshold: 1.61815
Finished step   -2  Threshold: 1.12231
Finished step   -1  Threshold: 1.20654
Finished step    0  Threshold: 1.03017
Finished step    1  Threshold: 0.959147
Finished step    2  Threshold: 1.2252
Finished step    3  Threshold: 0.994839
Finished step    4  Threshold: 1.18835
Finished step    5  Threshold: 2.99694

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.361283
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.873587
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.792333
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.820945
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.838353
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -5.9960e+04


dlp =

  -1.5622e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -5.0398e+04


dlp =

 -988.4927


lambda =

    1.5000


lp =

  -5.4503e+04


dlp =

  -1.1797e+03


lambda =

    1.2500


lp =

  -5.6997e+04


dlp =

  -1.3327e+03


lambda =

    1.1250


lp =

  -5.8407e+04


dlp =

  -1.4347e+03


lambda =

    1.0625


lp =

  -5.9164e+04


dlp =

  -1.4947e+03


lambda =

    1.0312


lp =

  -5.9556e+04


dlp =

  -1.5275e+03


lambda =

    1.0156


lp =

  -5.9757e+04


dlp =

  -1.5446e+03


lambda =

    1.0078


lp =

  -5.9858e+04


dlp =

  -1.5533e+03


lambda =

    1.0039


lp =

  -5.9909e+04


dlp =

  -1.5578e+03


lambda =

    1.0020


lp =

  -5.9934e+04


dlp =

  -1.5600e+03


lambda =

    1.0010


lp =

  -5.9947e+04


dlp =

  -1.5611e+03


lambda =

    1.0005


lp =

  -5.9953e+04


dlp =

  -1.5617e+03


lambda =

    1.0002


lp =

  -5.9957e+04


dlp =

  -1.5620e+03


lambda =

    1.0001


lp =

  -5.9958e+04


dlp =

  -1.5621e+03


lambda =

    1.0001


lp =

  -5.9959e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9959e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03


lambda =

    1.0000


lp =

  -5.9960e+04


dlp =

  -1.5622e+03

         1         27     0.00000e+00    -5.99598e+04     1.56224e+03
Step Size below progTol

ans =

     0

Iteration...2
Finished step   -4  Threshold: 1.16879
Finished step   -3  Threshold: 1.22592
Finished step   -2  Threshold: 1.62227
Finished step   -1  Threshold: 1.2334
Finished step    0  Threshold: 1.11507
Finished step    1  Threshold: 0.88449
{Operation terminated by user during DlogPosterior (line 44)


In hmc (line 182)
    p = p - epsilon*feval(gradf, x, varargin{:});

In EMTemplate (line 47)
    [samples] = hmc(@logPosterior, p, options, @DlogPosterior, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, lambda, voxelSize, sZ, freeformParams{1});

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 2.03991
Finished step   -3  Threshold: 1.43781
Finished step   -2  Threshold: 1.3487
Finished step   -1  Threshold: 1.64343
Finished step    0  Threshold: 0.827901
Finished step    1  Threshold: 1.36614
Finished step    2  Threshold: 1.52092
Finished step    3  Threshold: 1.07035
Finished step    4  Threshold: 0.687473
Finished step    5  Threshold: 0.609606

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.115675
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.332033
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.468844
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.594848
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.664391
Updating template for sample...5
Updating template for sample...5

lambda =

     1


lp =

  -5.9921e+04


dlp =

  -1.5624e+03

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

     2


lp =

  -5.0321e+04


dlp =

 -988.6037


lambda =

    1.5000


lp =

  -5.4445e+04


dlp =

  -1.1799e+03


lambda =

    1.2500


lp =

  -5.6949e+04


dlp =

  -1.3329e+03

{Operation terminated by user during logdet (line 86)


In logPosteriorLambda (line 49)
        logdetC = logdet(C,'chol');

In WolfeLineSearch (line 194)
        [f_new,g_new] = funObj(x + t*d,varargin{:});

In minFunc (line 1067)
            [t,f,g,LSfunEvals] = WolfeLineSearch(x,t,d,f,g,gtd,c1,c2,LS_interp,LS_multi,25,progTol,debug,doPlot,1,funObj,varargin{:});

In EMTemplate (line 95)
    pParam = minFunc(@logPosteriorLambda,pParam, optionsPred, pts, image, templateImage, ffSpacing,ffSupportInterp, ffSupportCov, iter, sigma, voxelSize, sZ, freeformParams, numSamples, ssd);

In mainRun (line 127)
    meanImage = EMTemplate(images, points, meanImage, freeformParams, ffSpacingInput,ffSupportInterp, ffSupportCov, i, sqrt(ssd), 1, voxelSize, image,numSamples);
} 
mainRun
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 15)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 16)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 17)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 18)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 19)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 20)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 21)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 22)] 
MEX completed successfully.
Building with 'g++'.
[Warning: You are using gcc version '4.8.4'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
[Warning: You are using gcc version '4.8.4-2ubuntu1~14.04.3)'. The version of gcc is not supported. The version currently supported with MEX is '4.7.x'. For a list of currently supported compilers see:
http://www.mathworks.com/support/compilers/current_release.] 
[> In mainRun (line 23)] 
MEX completed successfully.
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0
Rescaling NIFTI: slope = 1, intercept = 0
WARNING: xyz units code 0 is unrecognized
Rescaling NIFTI: slope = 1, intercept = 0

ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3


ans =

    15    17    15     3

Starting parallel pool (parpool) using the 'local' profile ... Parallel pool using the 'local' profile is shutting down.
connected to 22 workers.
Iteration...1
Finished step   -4  Threshold: 1.11695
Finished step   -3  Threshold: 1.24448
Finished step   -2  Threshold: 1.22454
Finished step   -1  Threshold: 1.04798
Finished step    0  Threshold: 0.781685
Finished step    1  Threshold: 0.939695
Finished step    2  Threshold: 1.08576
Finished step    3  Threshold: 0.987689
  Sample rejected    4.  Threshold: 0.678402
Finished step    5  Threshold: 0.651202

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.218245
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.190722
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.289820
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.289820
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.356264
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4083e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -6.0315e+04


dlp =

  -1.4512e+03


lambda =

    0.5010


lp =

  -6.8877e+04


dlp =

  -2.5952e+03


lambda =

    0.2510


lp =

  -7.7118e+04


dlp =

  -4.8765e+03


lambda =

    0.1260


lp =

  -8.5181e+04


dlp =

  -9.4119e+03


lambda =

    0.0635


lp =

  -9.3122e+04


dlp =

  -1.8376e+04


lambda =

    0.0323


lp =

  -1.0094e+05


dlp =

  -3.5886e+04


lambda =

    0.0166


lp =

  -1.0856e+05


dlp =

  -6.9327e+04


lambda =

    0.0088


lp =

  -1.1585e+05


dlp =

  -1.3052e+05


lambda =

    0.0049


lp =

  -1.2258e+05


dlp =

  -2.3419e+05


lambda =

    0.0030


lp =

  -1.2840e+05


dlp =

  -3.8888e+05


lambda =

    0.0020


lp =

  -1.3301e+05


dlp =

  -5.8086e+05


lambda =

    0.0015


lp =

  -1.3627e+05


dlp =

  -7.7133e+05


lambda =

    0.0012


lp =

  -1.3833e+05


dlp =

  -9.2263e+05


lambda =

    0.0011


lp =

  -1.3951e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.4015e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4049e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4066e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4075e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4079e+05


dlp =

  -1.1434e+06


lambda =

    0.0010


lp =

  -1.4081e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4082e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1475e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40833e+05     1.14780e+06
Step Size below progTol

ans =

     0

Iteration...2
Finished step   -4  Threshold: 1.27607
Finished step   -3  Threshold: 0.872193
  Sample rejected   -2.  Threshold: 0.807553
Finished step   -1  Threshold: 0.835472
Finished step    0  Threshold: 1.16447
Finished step    1  Threshold: 0.668653
Finished step    2  Threshold: 0.762211
Finished step    3  Threshold: 1.09956
Finished step    4  Threshold: 1.38924
  Sample rejected    5.  Threshold: 0.694704

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.032655
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.254933
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.329241
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.482231
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.482231
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4083e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -6.0224e+04


dlp =

  -1.4703e+03


lambda =

    0.5010


lp =

  -6.8832e+04


dlp =

  -2.6144e+03


lambda =

    0.2510


lp =

  -7.7095e+04


dlp =

  -4.8957e+03


lambda =

    0.1260


lp =

  -8.5170e+04


dlp =

  -9.4311e+03


lambda =

    0.0635


lp =

  -9.3116e+04


dlp =

  -1.8395e+04


lambda =

    0.0323


lp =

  -1.0093e+05


dlp =

  -3.5905e+04


lambda =

    0.0166


lp =

  -1.0856e+05


dlp =

  -6.9346e+04


lambda =

    0.0088


lp =

  -1.1585e+05


dlp =

  -1.3054e+05


lambda =

    0.0049


lp =

  -1.2258e+05


dlp =

  -2.3421e+05


lambda =

    0.0030


lp =

  -1.2840e+05


dlp =

  -3.8890e+05


lambda =

    0.0020


lp =

  -1.3301e+05


dlp =

  -5.8088e+05


lambda =

    0.0015


lp =

  -1.3627e+05


dlp =

  -7.7135e+05


lambda =

    0.0012


lp =

  -1.3833e+05


dlp =

  -9.2265e+05


lambda =

    0.0011


lp =

  -1.3951e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.4015e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4049e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4066e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4075e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4079e+05


dlp =

  -1.1435e+06


lambda =

    0.0010


lp =

  -1.4081e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4082e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4083e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40833e+05     1.14782e+06
Step Size below progTol

ans =

     0

Iteration...3
Finished step   -4  Threshold: 1.24182
Finished step   -3  Threshold: 1.20742
Finished step   -2  Threshold: 1.47154
Finished step   -1  Threshold: 0.891658
Finished step    0  Threshold: 0.987153
Finished step    1  Threshold: 1.76787
Finished step    2  Threshold: 1.15908
Finished step    3  Threshold: 1.20701
Finished step    4  Threshold: 0.601279
Finished step    5  Threshold: 1.79026

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.213903
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.268466
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.395143
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.556098
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.569091
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4043e+05


dlp =

  -1.1479e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9690e+04


dlp =

  -1.5165e+03


lambda =

    0.5010


lp =

  -6.8365e+04


dlp =

  -2.6606e+03


lambda =

    0.2510


lp =

  -7.6662e+04


dlp =

  -4.9419e+03


lambda =

    0.1260


lp =

  -8.4753e+04


dlp =

  -9.4773e+03


lambda =

    0.0635


lp =

  -9.2708e+04


dlp =

  -1.8441e+04


lambda =

    0.0322


lp =

  -1.0053e+05


dlp =

  -3.5952e+04


lambda =

    0.0166


lp =

  -1.0815e+05


dlp =

  -6.9393e+04


lambda =

    0.0088


lp =

  -1.1545e+05


dlp =

  -1.3058e+05


lambda =

    0.0049


lp =

  -1.2218e+05


dlp =

  -2.3426e+05


lambda =

    0.0030


lp =

  -1.2800e+05


dlp =

  -3.8894e+05


lambda =

    0.0020


lp =

  -1.3261e+05


dlp =

  -5.8092e+05


lambda =

    0.0015


lp =

  -1.3587e+05


dlp =

  -7.7139e+05


lambda =

    0.0012


lp =

  -1.3793e+05


dlp =

  -9.2269e+05


lambda =

    0.0011


lp =

  -1.3911e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.3975e+05


dlp =

  -1.0819e+06


lambda =

    0.0010


lp =

  -1.4009e+05


dlp =

  -1.1139e+06


lambda =

    0.0010


lp =

  -1.4026e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4035e+05


dlp =

  -1.1392e+06


lambda =

    0.0010


lp =

  -1.4039e+05


dlp =

  -1.1435e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1457e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1468e+06


lambda =

    0.0010


lp =

  -1.4043e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4043e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4043e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4043e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4043e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40432e+05     1.14787e+06
Step Size below progTol

ans =

     0

Iteration...4
Finished step   -4  Threshold: 1.24524
Finished step   -3  Threshold: 0.963872
Finished step   -2  Threshold: 1.05358
Finished step   -1  Threshold: 0.787526
Finished step    0  Threshold: 1.16355
Finished step    1  Threshold: 1.07516
Finished step    2  Threshold: 1.05422
Finished step    3  Threshold: 1.12807
Finished step    4  Threshold: 0.644978
Finished step    5  Threshold: 0.589787

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.104196
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.204035
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.310525
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.374033
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.498007
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4042e+05


dlp =

  -1.1479e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9557e+04


dlp =

  -1.5446e+03


lambda =

    0.5010


lp =

  -6.8292e+04


dlp =

  -2.6886e+03


lambda =

    0.2510


lp =

  -7.6619e+04


dlp =

  -4.9699e+03


lambda =

    0.1260


lp =

  -8.4726e+04


dlp =

  -9.5054e+03


lambda =

    0.0635


lp =

  -9.2688e+04


dlp =

  -1.8469e+04


lambda =

    0.0323


lp =

  -1.0051e+05


dlp =

  -3.5980e+04


lambda =

    0.0166


lp =

  -1.0814e+05


dlp =

  -6.9421e+04


lambda =

    0.0088


lp =

  -1.1544e+05


dlp =

  -1.3061e+05


lambda =

    0.0049


lp =

  -1.2216e+05


dlp =

  -2.3428e+05


lambda =

    0.0030


lp =

  -1.2799e+05


dlp =

  -3.8897e+05


lambda =

    0.0020


lp =

  -1.3260e+05


dlp =

  -5.8095e+05


lambda =

    0.0015


lp =

  -1.3586e+05


dlp =

  -7.7142e+05


lambda =

    0.0012


lp =

  -1.3791e+05


dlp =

  -9.2272e+05


lambda =

    0.0011


lp =

  -1.3910e+05


dlp =

  -1.0231e+06


lambda =

    0.0011


lp =

  -1.3974e+05


dlp =

  -1.0819e+06


lambda =

    0.0010


lp =

  -1.4007e+05


dlp =

  -1.1139e+06


lambda =

    0.0010


lp =

  -1.4025e+05


dlp =

  -1.1307e+06


lambda =

    0.0010


lp =

  -1.4033e+05


dlp =

  -1.1392e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1435e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1457e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1468e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1474e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1479e+06

         1         27     0.00000e+00    -1.40420e+05     1.14790e+06
Step Size below progTol

ans =

     0

Iteration...5
Finished step   -4  Threshold: 1.22489
Finished step   -3  Threshold: 1.05724
Finished step   -2  Threshold: 0.910378
Finished step   -1  Threshold: 0.856213
Finished step    0  Threshold: 1.61937
Finished step    1  Threshold: 1.25508
Finished step    2  Threshold: 1.61891
Finished step    3  Threshold: 0.841843
Finished step    4  Threshold: 0.562558
Finished step    5  Threshold: 0.746394

Fraction of samples rejected:  0
Max magnitude of deformation in sample...1	1.265883
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.360022
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.554643
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.717050
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.884450
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4040e+05


dlp =

  -1.1479e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9511e+04


dlp =

  -1.5673e+03


lambda =

    0.5010


lp =

  -6.8260e+04


dlp =

  -2.7113e+03


lambda =

    0.2510


lp =

  -7.6595e+04


dlp =

  -4.9926e+03


lambda =

    0.1260


lp =

  -8.4705e+04


dlp =

  -9.5281e+03


lambda =

    0.0635


lp =

  -9.2669e+04


dlp =

  -1.8492e+04


lambda =

    0.0323


lp =

  -1.0049e+05


dlp =

  -3.6002e+04


lambda =

    0.0166


lp =

  -1.0812e+05


dlp =

  -6.9443e+04


lambda =

    0.0088


lp =

  -1.1542e+05


dlp =

  -1.3063e+05


lambda =

    0.0049


lp =

  -1.2215e+05


dlp =

  -2.3431e+05


lambda =

    0.0030


lp =

  -1.2797e+05


dlp =

  -3.8899e+05


lambda =

    0.0020


lp =

  -1.3258e+05


dlp =

  -5.8097e+05


lambda =

    0.0015


lp =

  -1.3584e+05


dlp =

  -7.7144e+05


lambda =

    0.0012


lp =

  -1.3790e+05


dlp =

  -9.2274e+05


lambda =

    0.0011


lp =

  -1.3908e+05


dlp =

  -1.0231e+06


lambda =

    0.0011


lp =

  -1.3972e+05


dlp =

  -1.0819e+06


lambda =

    0.0010


lp =

  -1.4006e+05


dlp =

  -1.1139e+06


lambda =

    0.0010


lp =

  -1.4023e+05


dlp =

  -1.1307e+06


lambda =

    0.0010


lp =

  -1.4032e+05


dlp =

  -1.1392e+06


lambda =

    0.0010


lp =

  -1.4036e+05


dlp =

  -1.1436e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1457e+06


lambda =

    0.0010


lp =

  -1.4039e+05


dlp =

  -1.1468e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1474e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1479e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1479e+06

         1         27     0.00000e+00    -1.40403e+05     1.14792e+06
Step Size below progTol

ans =

     0

Iteration...6
Finished step   -4  Threshold: 1.24936
Finished step   -3  Threshold: 1.77213
Finished step   -2  Threshold: 1.29591
Finished step   -1  Threshold: 1.38975
  Sample rejected    0.  Threshold: 0.853832
Finished step    1  Threshold: 1.02372
Finished step    2  Threshold: 0.794726
Finished step    3  Threshold: 0.680276
  Sample rejected    4.  Threshold: 0.518613
  Sample rejected    5.  Threshold: 0.557794

Fraction of samples rejected:  0.4
Max magnitude of deformation in sample...1	1.215980
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.244080
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.535865
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.535865
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.535865
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4039e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9706e+04


dlp =

  -1.4456e+03


lambda =

    0.5010


lp =

  -6.8349e+04


dlp =

  -2.5897e+03


lambda =

    0.2510


lp =

  -7.6630e+04


dlp =

  -4.8710e+03


lambda =

    0.1260


lp =

  -8.4714e+04


dlp =

  -9.4064e+03


lambda =

    0.0635


lp =

  -9.2664e+04


dlp =

  -1.8370e+04


lambda =

    0.0322


lp =

  -1.0048e+05


dlp =

  -3.5881e+04


lambda =

    0.0166


lp =

  -1.0811e+05


dlp =

  -6.9322e+04


lambda =

    0.0088


lp =

  -1.1540e+05


dlp =

  -1.3051e+05


lambda =

    0.0049


lp =

  -1.2213e+05


dlp =

  -2.3418e+05


lambda =

    0.0030


lp =

  -1.2796e+05


dlp =

  -3.8887e+05


lambda =

    0.0020


lp =

  -1.3257e+05


dlp =

  -5.8085e+05


lambda =

    0.0015


lp =

  -1.3582e+05


dlp =

  -7.7132e+05


lambda =

    0.0012


lp =

  -1.3788e+05


dlp =

  -9.2262e+05


lambda =

    0.0011


lp =

  -1.3906e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.3971e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4004e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4021e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4030e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4034e+05


dlp =

  -1.1434e+06


lambda =

    0.0010


lp =

  -1.4036e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4037e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1475e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40385e+05     1.14780e+06
Step Size below progTol

ans =

     0

Iteration...7
Finished step   -4  Threshold: 1.03966
Finished step   -3  Threshold: 1.04592
Finished step   -2  Threshold: 1.15221
Finished step   -1  Threshold: 0.928235
Finished step    0  Threshold: 0.713973
  Sample rejected    1.  Threshold: 0.649323
Finished step    2  Threshold: 0.853939
Finished step    3  Threshold: 0.643366
Finished step    4  Threshold: 0.72398
Finished step    5  Threshold: 0.644421

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.123430
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.085636
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.295951
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.410071
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.489661
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4038e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9841e+04


dlp =

  -1.4646e+03


lambda =

    0.5010


lp =

  -6.8413e+04


dlp =

  -2.6087e+03


lambda =

    0.2510


lp =

  -7.6659e+04


dlp =

  -4.8900e+03


lambda =

    0.1260


lp =

  -8.4725e+04


dlp =

  -9.4254e+03


lambda =

    0.0635


lp =

  -9.2666e+04


dlp =

  -1.8389e+04


lambda =

    0.0323


lp =

  -1.0048e+05


dlp =

  -3.5900e+04


lambda =

    0.0166


lp =

  -1.0810e+05


dlp =

  -6.9341e+04


lambda =

    0.0088


lp =

  -1.1540e+05


dlp =

  -1.3053e+05


lambda =

    0.0049


lp =

  -1.2212e+05


dlp =

  -2.3420e+05


lambda =

    0.0030


lp =

  -1.2795e+05


dlp =

  -3.8889e+05


lambda =

    0.0020


lp =

  -1.3256e+05


dlp =

  -5.8087e+05


lambda =

    0.0015


lp =

  -1.3582e+05


dlp =

  -7.7134e+05


lambda =

    0.0012


lp =

  -1.3787e+05


dlp =

  -9.2264e+05


lambda =

    0.0011


lp =

  -1.3906e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.3970e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4003e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4020e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4029e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4033e+05


dlp =

  -1.1435e+06


lambda =

    0.0010


lp =

  -1.4036e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4037e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4037e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1475e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40378e+05     1.14782e+06
Step Size below progTol

ans =

     0

Iteration...8
Finished step   -4  Threshold: 1.07209
Finished step   -3  Threshold: 1.12298
Finished step   -2  Threshold: 0.991794
  Sample rejected   -1.  Threshold: 0.643406
Finished step    0  Threshold: 0.825312
  Sample rejected    1.  Threshold: 0.784243
Finished step    2  Threshold: 1.0463
Finished step    3  Threshold: 0.957025
Finished step    4  Threshold: 0.746801
Finished step    5  Threshold: 0.982768

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	0.935607
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.077637
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.442341
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.230982
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.304139
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4040e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -6.0039e+04


dlp =

  -1.4380e+03


lambda =

    0.5010


lp =

  -6.8522e+04


dlp =

  -2.5821e+03


lambda =

    0.2510


lp =

  -7.6723e+04


dlp =

  -4.8633e+03


lambda =

    0.1260


lp =

  -8.4767e+04


dlp =

  -9.3988e+03


lambda =

    0.0635


lp =

  -9.2697e+04


dlp =

  -1.8362e+04


lambda =

    0.0323


lp =

  -1.0051e+05


dlp =

  -3.5873e+04


lambda =

    0.0166


lp =

  -1.0813e+05


dlp =

  -6.9314e+04


lambda =

    0.0088


lp =

  -1.1542e+05


dlp =

  -1.3050e+05


lambda =

    0.0049


lp =

  -1.2214e+05


dlp =

  -2.3418e+05


lambda =

    0.0030


lp =

  -1.2797e+05


dlp =

  -3.8886e+05


lambda =

    0.0020


lp =

  -1.3258e+05


dlp =

  -5.8084e+05


lambda =

    0.0015


lp =

  -1.3583e+05


dlp =

  -7.7132e+05


lambda =

    0.0012


lp =

  -1.3789e+05


dlp =

  -9.2262e+05


lambda =

    0.0011


lp =

  -1.3908e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.3972e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4005e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4022e+05


dlp =

  -1.1305e+06


lambda =

    0.0010


lp =

  -1.4031e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4035e+05


dlp =

  -1.1434e+06


lambda =

    0.0010


lp =

  -1.4038e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4039e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4039e+05


dlp =

  -1.1472e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1475e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40398e+05     1.14779e+06
Step Size below progTol

ans =

     0

Iteration...9
Finished step   -4  Threshold: 1.03329
Finished step   -3  Threshold: 1.01889
Finished step   -2  Threshold: 0.898557
Finished step   -1  Threshold: 0.833027
Finished step    0  Threshold: 0.801894
Finished step    1  Threshold: 0.812065
  Sample rejected    2.  Threshold: 0.720074
Finished step    3  Threshold: 0.690081
Finished step    4  Threshold: 0.578387
  Sample rejected    5.  Threshold: 0.613474

Fraction of samples rejected:  0.4
Max magnitude of deformation in sample...1	1.208557
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.208557
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.239147
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.311207
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.311207
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4041e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9998e+04


dlp =

  -1.4196e+03


lambda =

    0.5010


lp =

  -6.8507e+04


dlp =

  -2.5636e+03


lambda =

    0.2510


lp =

  -7.6721e+04


dlp =

  -4.8449e+03


lambda =

    0.1260


lp =

  -8.4771e+04


dlp =

  -9.3803e+03


lambda =

    0.0635


lp =

  -9.2705e+04


dlp =

  -1.8344e+04


lambda =

    0.0323


lp =

  -1.0051e+05


dlp =

  -3.5855e+04


lambda =

    0.0166


lp =

  -1.0814e+05


dlp =

  -6.9296e+04


lambda =

    0.0088


lp =

  -1.1543e+05


dlp =

  -1.3049e+05


lambda =

    0.0049


lp =

  -1.2215e+05


dlp =

  -2.3416e+05


lambda =

    0.0030


lp =

  -1.2798e+05


dlp =

  -3.8884e+05


lambda =

    0.0020


lp =

  -1.3259e+05


dlp =

  -5.8083e+05


lambda =

    0.0015


lp =

  -1.3585e+05


dlp =

  -7.7130e+05


lambda =

    0.0012


lp =

  -1.3790e+05


dlp =

  -9.2260e+05


lambda =

    0.0011


lp =

  -1.3909e+05


dlp =

  -1.0229e+06


lambda =

    0.0011


lp =

  -1.3973e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4006e+05


dlp =

  -1.1138e+06


lambda =

    0.0010


lp =

  -1.4023e+05


dlp =

  -1.1305e+06


lambda =

    0.0010


lp =

  -1.4032e+05


dlp =

  -1.1391e+06


lambda =

    0.0010


lp =

  -1.4036e+05


dlp =

  -1.1434e+06


lambda =

    0.0010


lp =

  -1.4039e+05


dlp =

  -1.1456e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1467e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1472e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1475e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4041e+05


dlp =

  -1.1477e+06

         1         27     0.00000e+00    -1.40409e+05     1.14777e+06
Step Size below progTol

ans =

     0

Iteration...10
Finished step   -4  Threshold: 1.34994
Finished step   -3  Threshold: 0.885877
Finished step   -2  Threshold: 0.876978
Finished step   -1  Threshold: 0.720476
Finished step    0  Threshold: 0.797667
Finished step    1  Threshold: 0.794967
Finished step    2  Threshold: 0.593968
  Sample rejected    3.  Threshold: 0.447869
Finished step    4  Threshold: 0.802482
Finished step    5  Threshold: 0.93543

Fraction of samples rejected:  0.2
Max magnitude of deformation in sample...1	1.479657
Updating template for sample...1
Updating template for sample...1
Max magnitude of deformation in sample...2	1.692502
Updating template for sample...2
Updating template for sample...2
Max magnitude of deformation in sample...3	1.692502
Updating template for sample...3
Updating template for sample...3
Max magnitude of deformation in sample...4	1.732024
Updating template for sample...4
Updating template for sample...4
Max magnitude of deformation in sample...5	1.622433
Updating template for sample...5
Updating template for sample...5

lambda =

   1.0000e-03


lp =

  -1.4045e+05


dlp =

  -1.1478e+06

 Iteration   FunEvals     Step Length    Function Val        Opt Cond

lambda =

    1.0010


lp =

  -5.9745e+04


dlp =

  -1.4932e+03


lambda =

    0.5010


lp =

  -6.8399e+04


dlp =

  -2.6372e+03


lambda =

    0.2510


lp =

  -7.6686e+04


dlp =

  -4.9185e+03


lambda =

    0.1260


lp =

  -8.4772e+04


dlp =

  -9.4539e+03


lambda =

    0.0635


lp =

  -9.2724e+04


dlp =

  -1.8418e+04


lambda =

    0.0323


lp =

  -1.0054e+05


dlp =

  -3.5928e+04


lambda =

    0.0166


lp =

  -1.0817e+05


dlp =

  -6.9369e+04


lambda =

    0.0088


lp =

  -1.1546e+05


dlp =

  -1.3056e+05


lambda =

    0.0049


lp =

  -1.2219e+05


dlp =

  -2.3423e+05


lambda =

    0.0030


lp =

  -1.2802e+05


dlp =

  -3.8892e+05


lambda =

    0.0020


lp =

  -1.3263e+05


dlp =

  -5.8090e+05


lambda =

    0.0015


lp =

  -1.3588e+05


dlp =

  -7.7137e+05


lambda =

    0.0012


lp =

  -1.3794e+05


dlp =

  -9.2267e+05


lambda =

    0.0011


lp =

  -1.3912e+05


dlp =

  -1.0230e+06


lambda =

    0.0011


lp =

  -1.3977e+05


dlp =

  -1.0818e+06


lambda =

    0.0010


lp =

  -1.4010e+05


dlp =

  -1.1139e+06


lambda =

    0.0010


lp =

  -1.4027e+05


dlp =

  -1.1306e+06


lambda =

    0.0010


lp =

  -1.4036e+05


dlp =

  -1.1392e+06


lambda =

    0.0010


lp =

  -1.4040e+05


dlp =

  -1.1435e+06


lambda =

    0.0010


lp =

  -1.4042e+05


dlp =

  -1.1457e+06


lambda =

    0.0010


lp =

  -1.4044e+05


dlp =

  -1.1468e+06


lambda =

    0.0010


lp =

  -1.4044e+05


dlp =

  -1.1473e+06


lambda =

    0.0010


lp =

  -1.4044e+05


dlp =

  -1.1476e+06


lambda =

    0.0010


lp =

  -1.4045e+05


dlp =

  -1.1477e+06


lambda =

    0.0010


lp =

  -1.4045e+05


dlp =

  -1.1478e+06


lambda =

    0.0010


lp =

  -1.4045e+05


dlp =

  -1.1478e+06

         1         27     0.00000e+00    -1.40447e+05     1.14785e+06
Step Size below progTol

ans =

     0

Iteration...1
n
------------------------------------------------------------------------
       Segmentation violation detected at Fri Jun 10 23:01:39 2016
------------------------------------------------------------------------

Configuration:
  Crash Decoding      : Disabled
  Crash Mode          : continue (default)
  Current Graphics Driver: Unknown software 
  Current Visual      : None
  Default Encoding    : UTF-8
  GNU C Library       : 2.19 stable
  Host Name           : imgpu3
  MATLAB Architecture : glnxa64
  MATLAB Root         : /usr/local/MATLAB/R2015b
  MATLAB Version      : 8.6.0.267246 (R2015b)
  OpenGL              : software
  Operating System    : Linux 3.19.0-51-generic #58~14.04.1-Ubuntu SMP Fri Feb 26 22:02:58 UTC 2016 x86_64
  Processor ID        : x86 Family 6 Model 62 Stepping 4, GenuineIntel
  Virtual Machine     : Java 1.7.0_60-b19 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode
  Window System       : No active display

Fault Count: 1


Abnormal termination:
Segmentation violation

Register State (from fault):
  RAX = 000000000093e8b0  RBX = 00007f26796bfd40
  RCX = 000000000093e8b0  RDX = 00000000fdf2b758
  RSP = 00007f26796bfd40  RBP = 00007f2689d643a0
  RSI = 00000000fe86a008  RDI = 00007f252e2883a0

   R8 = 00007f2279060000   R9 = 00007f2438a027e0
  R10 = 0000000000000022  R11 = 0000000084000001
  R12 = 00007f2689d64360  R13 = 00007f2438a02820
  R14 = 00007f251b67a4a0  R15 = 00000000041a9150

  RIP = 00007f2535405909  EFL = 0000000000010206

   CS = 0033   FS = 0000   GS = 0000

Stack Trace (from fault):
[  0] 0x00007f2535405909 /home/pai/Zie_Template_Estimation/C++/wendsquarednorm.mexa64+00002313 mexFunction+00000404
[  1] 0x00007f26977fdc4a     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00142410 mexRunMexFile+00000090
[  2] 0x00007f26977fa244     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00127556
[  3] 0x00007f26977fade4     /usr/local/MATLAB/R2015b/bin/glnxa64/libmex.so+00130532
[  4] 0x00007f269bd9cdbd /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00724413 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00001549
[  5] 0x00007f269bd9d250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[  6] 0x00007f26964178af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[  7] 0x00007f269653b7ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[  8] 0x00007f2696564196 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09974166
[  9] 0x00007f26965199f1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09669105
[ 10] 0x00007f2696160d6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 11] 0x00007f269614b4c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 12] 0x00007f269615a075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 13] 0x00007f269632b033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 14] 0x00007f26964093bc /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08553404
[ 15] 0x00007f269bd9cb31 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00723761 _ZN8Mfh_file16dispatch_fh_implEMS_FviPP11mxArray_tagiS2_EiS2_iS2_+00000897
[ 16] 0x00007f269bd9d250 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_dispatcher.so+00725584 _ZN8Mfh_file11dispatch_fhEiPP11mxArray_tagiS2_+00000032
[ 17] 0x00007f26964178af /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+08612015
[ 18] 0x00007f269653b7ff /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09807871
[ 19] 0x00007f269653147f /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09766015
[ 20] 0x00007f26964fe981 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+09558401
[ 21] 0x00007f2696160d6c /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05766508
[ 22] 0x00007f269614b4c1 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05678273
[ 23] 0x00007f269615a075 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+05738613
[ 24] 0x00007f269632b033 /usr/local/MATLAB/R2015b/bin/glnxa64/libmwm_lxe.so+07643187
[ 25] 0x00007f26962f2c40 /usr/local/MATLAB